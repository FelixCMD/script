!window.pHash&&"undefined"!=typeof window.API&&API.getUser()&&!function(){var e={consts:{version:{major:0,minor:1,label:"alpha",string:"v0.1 alpha"},minSettingsVersion:{major:0,minor:1,label:"alpha",string:"v0.1 alpha"},links:{plugHash:"https://plughash-yals.c9users.io/plughash.js",baseURL:"https://rawgit.com/plughash/script/master/",langs:"",team:null,theme:null,css:"dark-UICSS",emotes:{plughash:"assets/json/emotes.json"}},plugRoles:{5:"host",4:"cohost",3:"manager",2:"bouncer",1:"residentdj",0:"none"}},settings:{expanded:!1,autoJoin:!1,autoLeave:!1,autoLeavePos:null,autoLeaveValue:5,afkEnabled:!1,afkMessage:null,accidentalNavigation:!1,defaultLang:"en",lang:null,chatImagesMaxSize:null,chatMentions:!1,chatMentionsArray:[API.getUser().username],customEmotes:!0,videoHidden:!1,videoFullscreen:!1,voting:{autoWoot:!0,reverseWoot:!1,autoMeh:!1,autoGrab:!1,silentGrab:!1,grabTo:null},customization:{legacyChat:!1,legacyFooter:!1,customMentionSound:null,background:null,chatColors:{admin:null,ba:null,host:null,cohost:null,manager:null,bouncer:null,rdj:null,subscriberGold:null,subscriberSilver:null,friend:null,user:null,self:null,banned:null},defaultColors:{admin:"#42A5DC",ba:"#89be6c",host:"#ac76ff",cohost:"#ac76ff",manager:"#ac76ff",bouncer:"#ac76ff",rdj:"#ac76ff",subscriberGold:"#c59840",subscriberSilver:"#8694b2",friend:"#777F92",user:"#777F92",self:"#FFDD6F",banned:"#C42E3B"}},staffTools:{chatLog:!1,deletedChat:!1,historyAlert:!1,durationAlert:!1,durationAlertLength:null},inlinePreviews:{images:!1,gifs:!1,videos:!1,audio:!1},emotes:{plughash:null,twitch:null,betterttv:null},notifications:{desktopNotifications:!1,join:{all:!1,admin:!1,ba:!1,staff:{host:!1,cohost:!1,manager:!1,bouncer:!1,rdj:!1},subscriberGold:!1,sinscronerSilver:!1,friend:!1,lvl1:!1,user:!1,guest:!1},leave:{all:!1,admin:!1,ba:!1,staff:{host:!1,cohost:!1,manager:!1,bouncer:!1,rdj:!1},subscriberGold:!1,sinscronerSilver:!1,friend:!1,lvl1:!1,user:!1,guest:!1},advance:{lastSong:!1,currentSong:!1,boothAlert:!1,boothAlertPos:null},currentSong:{woot:!1,grab:!1,meh:!1}}},session:{timeout:{},interval:{},afkMessage:{chat:{lastSent:0},"private":{}},waitList:[],dj:null,currentUser:null,lang:{list:null,loaded:null,language:"en"},emotes:{plugHash:null},autoLeave:{played:0},voteRollover:{vote:null},team:{}},ui:{buttons:[{type:"autoTools",description:"...",icon:"icon icon-join-waitlist",role:0,settingsValue:function(){return""},action:function(){var e=$(".plughash-MENU > .buttons-autoTasks"),t=e.hasClass("expanded");t?e.animate({left:"-=300px"},"fast").removeClass("expanded"):e.animate({left:"+=300px"},"fast").addClass("expanded")}},{type:"autoWoot",description:"...",icon:"icon icon-woot-disabled",subMenu:"autoTasks",role:0,tooltip:function(){return e.session.lang.loaded.settings.autoWoot},settingsValue:function(){return e.settings.voting.autoWoot?"":"disabled"},action:function(){var t=e.session.lang.loaded;e.settings.voting.autoWoot=!e.settings.voting.autoWoot;var s=t.settings.autoWoot+" "+(e.settings.voting.autoWoot?t.misc.enabled:t.misc.disabled);e.utils.addChat("log",s,"woot-disabled"),e.utils.votes.woot()}},{type:"autoJoin",description:"...",icon:"icon icon-join-waitlist",subMenu:"autoTasks",role:0,tooltip:function(){return e.session.lang.loaded.settings.autoJoin},settingsValue:function(){return e.settings.autoJoin?"":"disabled"},action:function(){var t=e.session.lang.loaded;e.settings.autoJoin=!e.settings.autoJoin;var s=t.settings.autoJoin+" "+(e.settings.autoJoin?t.misc.enabled:t.misc.disabled);e.utils.addChat("log",s,"join-waitlist"),e.events.modules.utils.joinBooth()}},{type:"autoLeave",description:"...",icon:"icon icon-leave-waitlist",subMenu:"autoTasks",role:0,tooltip:function(){return e.session.lang.loaded.settings.autoLeave},settingsValue:function(){return e.settings.autoLeave?"":"disabled"},action:function(){var t=e.session.lang.loaded;e.settings.autoLeave=!e.settings.autoLeave;var s=t.settings.autoLeave+" "+(e.settings.autoLeave?t.misc.enabled:t.misc.disabled);e.utils.addChat("log",s,"join-waitlist")}},{type:"autoGrab",description:"...",icon:"icon icon-grab-disabled",subMenu:"autoTasks",role:0,tooltip:function(){return e.session.lang.loaded.settings.autoGrab},settingsValue:function(){return e.settings.voting.autoGrab?"":"disabled"},action:function(){var t=e.session.lang.loaded;e.settings.voting.autoGrab=!e.settings.voting.autoGrab;var s=t.settings.autoGrab+" "+(e.settings.voting.autoGrab?t.misc.enabled:t.misc.disabled);e.utils.addChat("log",s,"grab-disabled"),e.utils.votes.grab(e.settings.voting.silentGrab)}},{type:"reverseWoot",description:"...",icon:"icon icon-woot-disabled",role:0,settingsValue:function(){return e.settings.voting.reverseWoot?"":"disabled"},action:function(){var t=e.session.lang.loaded;e.settings.voting.reverseWoot=!e.settings.voting.reverseWoot;var s=t.settings.reverseWoot+" "+(e.settings.voting.reverseWoot?t.misc.enabled:t.misc.disabled);e.utils.addChat("log",s,"woot-disabled")}},{type:"silentGrab",description:"...",icon:"icon icon-grab-disabled",role:0,settingsValue:function(){return e.settings.voting.silentGrab?"":"disabled"},action:function(){var t=e.session.lang.loaded;e.settings.voting.silentGrab=!e.settings.voting.silentGrab;var s=t.settings.silentGrab+" "+(e.settings.voting.silentGrab?t.misc.enabled:t.misc.disabled);e.utils.addChat("log",s,"grab-disabled"),e.settings.voting.autoGrab&&e.utils.votes.grab(e.settings.voting.silentGrab)}},{type:"chatNotifications",description:"...",icon:"icon icon-ignore",role:0,settingsValue:function(){return""},action:function(){var e=$(".plughash-MENU > .buttons-notifications"),t=e.hasClass("expanded");t?e.animate({left:"-=300px"},"fast").removeClass("expanded"):e.animate({left:"+=300px"},"fast").addClass("expanded")}},{type:"userWoots",description:"...",icon:"icon icon-woot",subMenu:"notifications",role:0,tooltip:function(){return e.session.lang.loaded.notifications.user.userWoots},settingsValue:function(){return e.settings.notifications.currentSong.woot?"":"disabled"},action:function(){var t=e.session.lang.loaded;e.settings.notifications.currentSong.woot=!e.settings.notifications.currentSong.woot;var s=t.notifications.user.userWoots+" "+(e.settings.notifications.currentSong.woot?t.misc.enabled:t.misc.disabled);e.utils.addChat("log",s,"woot")}},{type:"userMehs",description:"...",icon:"icon icon-meh",subMenu:"notifications",role:0,tooltip:function(){return e.session.lang.loaded.notifications.user.userMehs},settingsValue:function(){return e.settings.notifications.currentSong.meh?"":"disabled"},action:function(){var t=e.session.lang.loaded;e.settings.notifications.currentSong.meh=!e.settings.notifications.currentSong.meh;var s=t.notifications.user.userMehs+" "+(e.settings.notifications.currentSong.meh?t.misc.enabled:t.misc.disabled);e.utils.addChat("log",s,"meh")}},{type:"userGrabs",description:"...",icon:"icon icon-grab",subMenu:"notifications",role:0,tooltip:function(){return e.session.lang.loaded.notifications.user.userGrabs},settingsValue:function(){return e.settings.notifications.currentSong.grab?"":"disabled"},action:function(){var t=e.session.lang.loaded;e.settings.notifications.currentSong.grab=!e.settings.notifications.currentSong.grab;var s=t.notifications.user.userGrabs+" "+(e.settings.notifications.currentSong.grab?t.misc.enabled:t.misc.disabled);e.utils.addChat("log",s,"grab")}},{type:"userJoin",description:"...",icon:"icon icon-community-users",subMenu:"notifications",role:0,tooltip:function(){return e.session.lang.loaded.notifications.user.userJoin},settingsValue:function(){return e.settings.notifications.join.user?"":"disabled"},action:function(){var t=e.session.lang.loaded;e.settings.notifications.join.user=!e.settings.notifications.join.user;var s=t.notifications.user.userJoin+" "+(e.settings.notifications.join.user?t.misc.enabled:t.misc.disabled);e.utils.addChat("log",s,"community-users")}},{type:"userLeave",description:"...",icon:"icon icon-ban",subMenu:"notifications",role:0,tooltip:function(){return e.session.lang.loaded.notifications.user.userLeave},settingsValue:function(){return e.settings.notifications.leave.user?"":"disabled"},action:function(){var t=e.session.lang.loaded;e.settings.notifications.leave.user=!e.settings.notifications.leave.user;var s=t.notifications.user.userLeave+" "+(e.settings.notifications.leave.user?t.misc.enabled:t.misc.disabled);e.utils.addChat("log",s,"community-users")}},{type:"afkMessage",description:"...",icon:"icon icon-unignore",role:0,settingsValue:function(){return e.settings.afkEnabled?"":"disabled"},action:function(){var t=e.session.lang.loaded;e.settings.afkEnabled=!e.settings.afkEnabled;var s=t.settings.afkMessage+" "+(e.settings.afkEnabled?t.misc.enabled:t.misc.disabled);e.utils.addChat("log",s,"unignore")}},{type:"customMentions",description:"...",icon:"icon icon-mention",role:0,settingsValue:function(){return e.settings.chatMentions?"":"disabled"},action:function(){var t=e.session.lang.loaded;e.settings.chatMentions=!e.settings.chatMentions;var s=t.settings.customMentions+" "+(e.settings.chatMentions?t.misc.enabled:t.misc.disabled);e.utils.addChat("log",s,"mention")}},{type:"customEmotes",description:"...",icon:"icon icon-emoji-on",role:0,settingsValue:function(){return e.settings.customEmotes?"":"disabled"},action:function(){var t=e.session.lang.loaded;e.settings.customEmotes=!e.settings.customEmotes;var s=t.settings.customEmotes+" "+(e.settings.customEmotes?t.misc.enabled:t.misc.disabled);e.utils.addChat("log",s,"emoji-on")}},{type:"kill",description:"...",icon:"icon icon-dialog-close",role:0,settingsValue:function(){return""},action:function(){e.kill()}}],loadUI:function(){var t=e.session.lang.loaded;$("body").append('<div id="plughash-UI"></div>'),$("#plughash-UI").append('<div class="plughash-MENU"><button type="button" id="expand-menu" class="expand button" data-tooltip="Hide/Show Menu"><i class="icon icon-swap"></i></button><div id="button-options" class="expanded buttons"></div><div id="button-notifications" class="buttons-notifications"></div><div id="button-autoTasks" class="buttons-autoTasks"></div></div>'),$.each(e.ui.buttons,function(s,o){(o.role<=API.getUser().role||o.role<=API.getUser().gRole)&&($(o.subMenu?"#button-"+o.subMenu:"#button-options").append('<button type="button" id="'+o.type+'" data-tooltip="'+(o.tooltip?o.tooltip():t.settings[o.type])+'" class="'+(o.subMenu?o.subMenu+" ":"")+o.type+" button "+o.settingsValue()+'"><i class="'+o.icon+'"></i></button>'),$("#"+o.type).on("click",function(){o.action(),$(this).hasClass("disabled")?$(this).removeClass("disabled"):$(this).addClass("disabled"),e&&e.storage.save()}))}),$("#expand-menu").on("click",function(){var t=$(".plughash-MENU > .buttons"),s=$(".plughash-MENU > .buttons-notifications"),o=$(".plughash-MENU > .buttons-autoTasks"),n=($(".plughash-MENU .expand.button"),s.hasClass("expanded")),i=o.hasClass("expanded"),a=t.hasClass("expanded");a?(t.animate({left:"-=50px"},"fast").removeClass("expanded"),e.settings.expanded=!1,n&&i?($("#chatNotifications").click(),$("#autoTools").click()):i?$("#autoTools").click():n&&$("#chatNotifications").click()):(t.animate({left:"+=50px"},"fast").addClass("expanded"),e.settings.expanded=!0,n&&i?($("#chatNotifications").click(),$("#autoTools").click()):i?$("#autoTools").click():n&&$("#chatNotifications").click())}),$(".app-view").append('<div class="pop-menu vote" style="height: 234px; left: 668px; top: 268px; display: none"><div class="bar">									<i class="icon icon-grab-disabled"></i><span class="title"></span><div class="bar-divider"></div></div>									<div class="menu" style="height: 186px;"><ul></ul></div></div>'),$(".pop-menu.vote").on("mouseout",e.ui.voteRollover.voteMouseLeave).on("mouseover",function(){$(this).show()}),$("#app").on("mouseout",e.ui.voteRollover.voteMouseLeave),$("#woot, #grab, #meh").on("mouseover",e.ui.voteRollover.mouseOver),$("#vote").on("mouseover",e.ui.voteRollover.voteMouseOver),e.ui.voteRollover.resize(),$(window).resize(e.events.ui.resize),$(document).on("click",".pop-menu.vote li",e.ui.voteRollover.userSelected),$("#button-options button").on("mouseover",e.ui.tooltip.show),$("#button-options button").on("mouseout",e.ui.tooltip.hide),$("#button-notifications button").on("mouseover",e.ui.tooltip.show),$("#button-notifications button").on("mouseout",e.ui.tooltip.hide),$("#button-autoTasks button").on("mouseover",e.ui.tooltip.show),$("#button-autoTasks button").on("mouseout",e.ui.tooltip.hide),$(document).on("mouseover",".rank",e.ui.roles.showTooltip),$(document).on("mouseout",".rank",e.ui.roles.hideTooltip)},unloadUI:function(){$("#plughash-UI").remove(),$("#app").off("mouseout",e.ui.voteRollover.voteMouseLeave),$(".pop-menu.vote").off().remove(),$("#woot, #grab, #meh").off("mouseover",e.ui.voteRollover.mouseOver),$("#vote").off("mouseover",e.ui.voteRollover.voteMouseOver),$("#button-options button").off("mouseover",e.ui.tooltip.show),$("#button-options button").off("mouseout",e.ui.tooltip.hide),$("#button-notifications button").off("mouseover",e.ui.tooltip.show),$("#button-notifications button").off("mouseout",e.ui.tooltip.hide),$("#button-autoTasks button").off("mouseover",e.ui.tooltip.show),$("#button-autoTasks button").off("mouseout",e.ui.tooltip.hide),$(window).off("resize",e.events.ui.resize),$(document).off("click",".pop-menu.vote li",e.ui.voteRollover.userSelected),$(document).off("mouseover",".rank",e.ui.roles.showTooltip),$(document).off("mouseout",".rank",e.ui.roles.hideTooltip);var t=API.getUser(),s=e.modules.rollover;t.gRole||(s.$meta.removeClass(".has-id"),s.$meta.find(".user-id").remove()),e.modules.rollover.$meta.find('i[class*="rank rank-"]').remove(),$('i[class*="rank rank-"]').remove()},loadCSS:function(t){switch(t||""){case"dark-THEMECSS":case"white-THEMECSS":case"pink-THEMECSS":$("head").append('<link id="phash-UICSS" rel="stylesheet" type="text/css" href="'+e.consts.links.baseURL+"assets/css/"+t+'.css" />');break;case"dark-UICSS":case"white-UICSS":case"pink-UICSS":$("head").append('<link id="phash-THEMECSS" rel="stylesheet" type="text/css" href="'+e.consts.links.baseURL+"assets/css/"+t+'.css" />');break;default:t?$("head").append('<link id="phash-THEMECSS" rel="stylesheet" type="text/css" href="'+t+'" />'):$("head").append('<link id="phash-UICSS" rel="stylesheet" type="text/css" href="'+e.consts.links.css+'" />')}},unloadCSS:function(){$("#phash-UICSS").remove(),$("#phash-THEMECSS").remove()},addDeleteButton:function(t){var s=API.getUser();if(s&&s.id==t.uid&&!(Math.max(s.role,s.gRole)<2)){var o=$('div[data-cid^="'+t.cid+'"]').last();if(o.length){var n=e.modules.lang.chat["delete"];o.append('<div class="delete-button">'+n+"</div>"),o.hover(function(){return $(this).find(".delete-button").css("display","block")}),o.mouseleave(function(){return $(this).find(".delete-button").css("display","none")}),o.find(".delete-button").on("click",function(){e.utils.ajax("CHAT/"+t.cid,"DELETE")})}}},getUserIcon:function(e){if(e.gRole)return e.gRole<5?"ambassador":"admin";if(0==e.role){if(e.sub)return"subscriber";if(e.silver)return"silver-subscriber"}return 5==e.role||4==e.role?"host":3==e.role?"manager":2==e.role?"bouncer":1==e.role?"dj":""},voteRollover:{resize:function(t){var s={left:0,top:0},o=null,n=$(document),i=n.find("#vote"),a=n.find(".pop-menu"),l=parseInt(a.css("width").match(/\d{1,}/)[0]),u=parseInt(i.css("width").match(/\d{1,}/)[0]),o=i;if(n.find("#video-only-dj").length||n.find(".popout").length){switch(e.session.voteRollover.vote){case-1:o=n.find("#meh");break;case 0:o=n.find("#grab");break;default:o=n.find("#woot")}var r=parseInt(o.css("width").match(/\d{1,}/)[0]),d=l-r,c=(parseInt(o.css("width").match(/\d{1,}/)[0]),i.offset());s.left=o.offset().left-d/2,c.left+u<s.left+l&&(s.left=c.left+u-l)}else{var r=parseInt(o.css("width").match(/\d{1,}/)[0]),d=l-r;s.left=o.offset().left-d/2}s.left<0&&(s.left=0),s.top=o.offset().top-234,s.left=s.left+"px",s.top=s.top+"px",n.find(".pop-menu.vote").css(s)},mouseOver:function(){e.ui.voteRollover.list($(this).attr("id"))},voteMouseOver:function(){e.ui.voteRollover.resize(),$(this).parents().last().find(".pop-menu.vote").show()},voteMouseLeave:function(){$(this).parents().last().find(".pop-menu.vote").hide(),e.session.voteRollover.vote=null},vote:function(t){e.session.voteRollover.vote==t.vote&&e.ui.voteRollover.updvote(t.vote)},grab:function(t){0==e.session.voteRollover.vote&&e.ui.voteRollover.updvote(0)},updvote:function(){var t=API.getUsers().filter(function(t){return e.session.voteRollover.vote?t.vote==e.session.voteRollover.vote:t.grab}),s="",o="";for(var n in t)o=e.ui.getUserIcon(t[n]),s+="<li>"+(o?'<i class="icon icon-chat-'+o+'"></i>':"")+'<span class="'+o+'">'+_.escape(t[n].username)+"</span></li>";var i=$(document);i.find(".pop-menu.vote .menu > ul").html(s)},list:function(t){var s="woot"==t?1:"meh"==t?-1:0;if(s!=e.session.voteRollover.vote){e.session.voteRollover.vote=s;var o=$(document);o.find(".pop-menu.vote .bar .icon").attr("class","icon icon-"+t+"-disabled"),o.find(".pop-menu.vote .bar .title").text(o.find("#"+t).find(".top .label").text()),e.ui.voteRollover.updvote(e.session.voteRollover.vote)}},userSelected:function(t){var s=e.modules.users.findWhere({username:$(this).find("span").text()});s&&e.modules.rollover.showChat(s,{x:t.pageX,y:t.pageY})}},tooltip:{show:function(t){var s=$(this);e.modules.events.trigger("tooltip:show",t.currentTarget.attributes[2].value,s)},hide:function(t){var s=$(this);e.modules.events.trigger("tooltip:hide",t.currentTarget.attributes[2].value,s)}},roles:{showTooltip:function(t){var s=($(this).attr("class").match(/rank-(.*)(\s|$)/)||[])[1];if(s){var o=e.session.lang.loaded,n=o.plugHashRoles[s];if("rankwhore"==s){var i=o.plugHashRoles.whoreTitles;i.length&&(n=i[Math.round(100*Math.random()%(i.length-1))])}e.modules.events.trigger("tooltip:show",n,$(this))}},hideTooltip:function(t){e.modules.events.trigger("tooltip:hide")}}},utils:{addLog:function(e,t,s){$("#chat-messages")},addSpecial:function(t,s,o,n){var i=e.modules.settings.settings.chatTimestamps,a=e.modules.util.getChatTimestamp(24==i),l={type:"phash special-"+(t?t:"log"),message:s||e.session.lang.loaded.misc.msgerror,uid:n?n.id:13437704,un:n?n.username:"plug#",timestamp:a,cid:"phash-"+Math.floor(0x4bffe996c5d15*Math.random())};e.modules.chat.chatView.onReceived(l),$("[data-cid="+l.cid+"] .badge-box").children().remove(),$("[data-cid="+l.cid+"] .badge-box").removeClass("no-badge"),$("[data-cid="+l.cid+"] .badge-box").append('<i class="'+o+'"></i>'),$("#chat-messages").scrollTop($("#chat-messages").prop("scrollHeight"))},addChat:function(t,s,o,n){var i=e.modules.settings.settings.chatTimestamps,a=e.modules.util.getChatTimestamp(24==i),l={type:"phash plughash-"+(t?t:"log"),message:s||e.session.lang.loaded.misc.msgerror,uid:n?n.id:13437704,un:n?n.username:"plug#",timestamp:a,cid:"phash-"+Math.floor(0x4bffe996c5d15*Math.random())};e.modules.chat.chatView.onReceived(l),$("[data-cid="+l.cid+"] .badge-box").children().remove(),$("[data-cid="+l.cid+"] .badge-box").removeClass("no-badge"),$("[data-cid="+l.cid+"] .badge-box").append('<i class="icon icon-'+o+'"></i>'),$("#chat-messages").scrollTop($("#chat-messages").prop("scrollHeight"))},customMention:function(t){var s=[],o=e.settings.chatMentionsArray;for(var n in o)-1!=t.message.indexOf(o[n])&&-1==s.indexOf(o[n])&&s.push(o[n]);if(s.length){t.type="mention",t.sound="mention","undefined"==typeof t.mentions&&(t.mentions=[]);for(var n in s)-1==t.mentions.indexOf(s[n])&&(t.mentions.push(s[n]),t.message.replace(new RegExp(RegExp.escape(s[n]),"g"),'<span class="name">'+s[n]+"</span>"))}},getLangs:function(t){"function"==typeof t&&$.getJSON(e.consts.links.baseURL+"assets/json/lang.json",function(s){e.session.lang.list=s,t(s)})},loadLang:function(t,s){if("string"==typeof t&&"function"==typeof s){if(!e.session.lang.list)return void this.getLangs(function(){e.utils.loadLang(t,s)});e.session.lang.list.hasOwnProperty(t)||(t=e.settings.defaultLang),$.getJSON(e.consts.links.baseURL+"assets/json/languages/"+t+".json",function(t){e.session.lang.loaded=t,s(t)})}},replaceLang:function(e,t){return"string"!=typeof e?"[ERR] Invalid text":t&&"object"==typeof t?($.each(t,function(t,s){e=e.replace("%%"+t.toUpperCase()+"%%",s)}),e):e},team:{loadTeam:function(t){$.getJSON(e.consts.links.baseURL+"assets/json/team.json",function(s){e.session.team=s,"function"==typeof t&&t(s)})},getRole:function(t){var s=[];return e.session.team?($.each(e.session.team,function(e,o){-1!=o.users.indexOf(t)&&s.push(e)}),s):s}},emotes:{getEmotes:function(t){$.getJSON(e.consts.links.baseURL+e.consts.links.emotes.plughash,function(s){e.session.emotes=s,"function"==typeof t&&t(s)})},replace:function(e,t,s){var o=e.message.match(/:(.*?):/g);o&&o.forEach(function(o){var n=o.slice(1,-1).toLowerCase();if(t.hasOwnProperty(n)){var i={url:t[n].hasOwnProperty("url")?t[n].url:t._template.url.replace("{code}",t[n]),width:t[n].hasOwnProperty("width")?t[n].width:t._template.width,height:t[n].hasOwnProperty("height")?t[n].height:t._template.height};e.message=e.message.replace(new RegExp(o,"gi"),function(e){return'<div class="custom-emote" title="&#58;'+n+'&#58;" style="background-image:url('+i.url+"); background-repeat: no-repeat; "+(s?"background-size: contain;":"")+" width:"+i.width+"; height:"+i.height+';"></div>'})}})},replaceEmotes:function(t){var s=$("#chat-messages"),o=s.scrollTop()>s[0].scrollHeight-s.height()-28;e.session.emotes.plughash&&this.replace(t,e.session.emotes.plughash),e.session.emotes.twitch&&this.replace(t,e.session.emotes.twitch,!0),o&&s.scrollTop(s[0].scrollHeight)}},ajax:function(e,t,s,o){var n=$.ajax({type:t||"GET",url:"/_/"+e.toLowerCase(),contentType:s?"application/json":void 0,data:s?JSON.stringify(s):void 0});"function"==typeof o&&(n.done(function(e){o(null,e)}),n.fail(function(e,t){o({jqXHR:e,textStatus:t})}))},deleteChat:function(t){e.utils.ajax("chat/"+t,"DELETE")},getUser:function(t,s){if(isNaN(t)){var o=API.getUsers().filter(function(e){return e.username==t})[0]||null;if("function"!=typeof s)return o;s(o)}else"function"==typeof s&&e.utils.ajax("USERS/"+t,"GET",void 0,function(e,t){return s(e?null:t.data[0])})},getPlaylist:function(t,s){e.utils.ajax("PLAYLISTS/"+t+"/MEDIA","GET",void 0,function(e,t){return t=t.data,s(e?null:t)})},getPlaylists:function(t){e.utils.ajax("PLAYLISTS","GET",void 0,function(e,s){return s=s.data,t(e?null:s)})},addToPlaylist:function(t,s,o,n){s.id=0,e.utils.ajax("PLAYLISTS/"+t+"/MEDIA/INSERT","POST",{media:[s],append:o||!1},function(s,i){o&&!s&&i&&i.data&&e.utils.getPlaylist(t,function(s){s&&s.length&&e.utils.ajax("PLAYLISTS/"+t+"/MEDIA/MOVE","PUT",{ids:[s[0].id],beforeID:-1})}),n&&"function"==typeof n&&n(s?s:null,i.data[0])})},isLocked:function(){return e.modules.booth.isLocked},isCycling:function(){return e.modules.booth.shouldCycle},media:{addYoutubeVideo:function(t,s,o){if(!e.modules.playlists.get(s))return!1;var n=/^.*(youtu.be\/|v\/|u\/\w\/|embed\/|watch\?v=|\&v=)([^#\&\?]*).*/,i=t.match(n);return i&&11==i[2].length?($.getJSON("https://www.googleapis.com/youtube/v3/videos?id="+i[2]+"&part=snippet,contentDetails,statistics,status&key=AIzaSyCXdCG_sDuHISSSFcbUmJatH70nS9NYnTs",function(t){if(!t||!t.items||!t.items.length)return void("function"==typeof o&&o(null));var n=t.items[0],i=n.contentDetails.duration.match(/^P([0-9]+D|)?T?([0-9]+H|)?([0-9]+M|)?([0-9]+S|)?$/).reverse();i.pop();var a={id:0,format:1,cid:n.id,author:"",title:"",image:n.snippet.thumbnails["default"].url,duration:0},l=n.snippet.title,u=l.indexOf("-"),r=[0,60,3600,86400];u>0?(a.author=l.substr(0,u).trim(),a.title=l.substr(u+1).trim()):(a.author=n.snippet.channelTitle,a.title=l),i.forEach(function(e,t){e&&(a.duration+=parseInt(e.match(/\d{1,}/)[0])*r[t])}),e.utils.addToPlaylist(s,a,!1,function(e){"function"==typeof o&&o(e?null:a)})}).fail(function(){"function"==typeof o&&o(null)}),!0):!1},addSoundCloudSong:function(e,t,s){}},votes:{woot:function(t){var s=API.getUser();if(e.modules.media&&s&&1!=s.vote){var o=e.settings.voting.reverseWoot;(!o||t===!0&&o)&&$("#woot").click()}},meh:function(){var t=API.getUser();e.modules.media&&t&&-1!=t.vote&&$("#meh").click()},grab:function(t,s){"boolean"==typeof t&&(s=t,t=null);var o=e.modules.playlists.getActiveID();t=t||e.settings.voting.grabTo||o;var n=e.modules.media,i=API.getUser(),a=API.getDJ();if(t&&n&&i&&!i.grab&&a&&a.id!=i.id)if(s)e.utils.addToPlaylist(t,n,o==t);else{var l=e.modules.playlists.get(t);if(!l)return;l=l.toJSON(),$("#grab").click();var u=$(".pop-menu.grab li");u.filter(function(e){return $(u[e]).find("span").text()==l.name}).trigger("mousedown")}}}},commands:{shrug:function(e,t){API.sendChat(t.join(" ")+" ¯\\_(ツ)_/¯")},lenny:function(e,t){API.sendChat(t.join(" ")+" ( ͡° ͜ʖ ͡°)")},cat:function(e,t){API.sendChat(t.join(" ")+" =^.^=")},crazy:function(e,t){API.sendChat(t.join(" ")+" {{{(>_<)}}}")},coolsong:function(e,t){API.sendChat(t.join(" ")+" d(^_^)b")},cry:function(e,t){API.sendChat(t.join(" ")+" (╥﹏╥)")},yuno:function(e,t){API.sendChat(t.join(" ")+" ლ(ಠ益ಠლ)")},bearface:function(e,t){API.sendChat(t.join(" ")+" ʕ•ᴥ•ʔ")},wtf:function(e,t){API.sendChat(t.join(" ")+" ಠ_ಠ")},iamfine:function(e,t){API.sendChat(t.join(" ")+" ⁀‿⁀")},iamangry:function(e,t){API.sendChat(t.join(" ")+" ╰_╯")},facepalm:function(e,t){API.sendChat(t.join(" ")+" (>ლ)")},shy:function(e,t){API.sendChat(t.join(" ")+" (｡◕‿◕｡)")},dwi:function(e,t){API.sendChat(t.join(" ")+" (⌐■_■)")},x1:function(e,t){API.sendChat(t.join(" ")+" (ง'̀-'́)ง")},machoman:function(e,t){API.sendChat(t.join(" ")+" ᕦ( ͡° ͜ʖ ͡°)ᕤ")},runsong:function(e,t){API.sendChat(t.join(" ")+" ᕕ(⌐■_■)ᕗ ♪♬")},gasp:function(e,t){API.sendChat(t.join(" ")+" (ʘᗩʘ’)")},creepy:function(e,t){API.sendChat(t.join(" ")+" ╭(ʘ̆~◞౪◟~ʘ̆)╮")},pls:function(e,t){API.sendChat(t.join(" ")+" 〳 •́ ﹏ •̀ 〵")},partyover:function(e,t){API.sendChat(t.join(" ")+" ᕕ{  ͒ ʖ̯  ͒  }ᕗ")},aww:function(e,t){API.sendChat(t.join(" ")+" ʕ ಡ ﹏ ಡ ʔ")},wise:function(e,t){API.sendChat(t.join(" ")+" (҂ ˘ _ ˘ )")},"this":function(e,t){API.sendChat(t.join(" ")+" ☜(ﾟヮﾟ☜)")},squad:function(e,t){API.sendChat(t.join(" ")+" ヽ༼ ຈل͜ຈ༼ ▀̿̿Ĺ̯̿̿▀̿ ̿༽Ɵ͆ل͜Ɵ͆ ༽ﾉ")},itsmagic:function(e,t){API.sendChat(t.join(" ")+" (⊃｡•́‿•̀｡)⊃━☆ﾟ.*･｡ﾟ")},wat:function(e,t){API.sendChat(t.join(" ")+" ʕ ͠° ʖ̫ °͠ ʔ")},whatever:function(e,t){API.sendChat(t.join(" ")+" ¯\\_(⊙_ʖ⊙)_/¯")},m8:function(e,t){API.sendChat(t.join(" ")+" ლ ( ◕  ᗜ  ◕ ) ლ")},cool:function(e,t){API.sendChat(t.join(" ")+" s( ^ ‿ ^)-b")},praise:function(e,t){API.sendChat(t.join(" ")+" ༼つ ◕_◕ ༽つ")},gary:function(e,t){API.sendChat(t.join(" ")+" ᕕ( ᐛ )ᕗ")},afk:function(t,s){var o=e.session.lang.loaded;return 0==s.length?e.utils.addChat("success",o.settings.afkMessage+": "+(e.settings.afkMessage||o.settings.afkMessageDefault),"unignore"):(e.settings.afkMessage=s.join(" "),void e.utils.addChat("success",o.settings.afkMessage+": "+e.settings.afkMessage))},autoleave:function(t,s){var o=e.session.lang.loaded;if(0==s.length)return void(e.settings.autoLeave?e.utils.addChat("success",o.settings.autoLeave+": "+e.session.autoLeave.played+"/"+e.settings.autoLeavePos,"leave-waitlist"):e.utils.addChat("success",o.settings.autoLeave+": "+o.misc.disabled,"leave-waitlist"));var n=parseInt(s.shift());isNaN(n)||1>n||(e.settings.autoLeavePos=n,e.session.autoLeave.played=0,e.utils.addChat("success",o.settings.autoLeave+": "+e.session.autoLeave.played+"/"+e.settings.autoLeavePos,"leave-waitlist"))},addvideo:function(t,s){if(s.length<2)return e.utils.addChat("error",e.session.lang.loaded.commands.addvideo.insufficientArgs);var o=s.shift(),n=s.join(" "),i=e.modules.playlists.findWhere({name:n});return i?void(e.utils.media.addYoutubeVideo(o,i.get("id"),function(t){t?e.utils.addChat("success",e.utils.replaceLang(e.session.lang.loaded.commands.addvideo.added,{author:t.author,title:t.title,playlistname:n}),"playlist-small"):e.utils.addChat("error",e.session.lang.loaded.commands.addvideo.failed,"playlist-small")})||e.utils.addChat("error",e.session.lang.loaded.commands.addvideo.failed,"playlist-small")):e.utils.addChat("error",e.session.lang.loaded.commands.addvideo.playlistNotFound,"playlist-small")},addsong:function(e,t){},move:function(t,s){var o=s.splice(s.length-1),n=s.join(" ");n=n.replace("@",""),self=API.getUser(),e.utils.getUser(n,function(t){return null==t?e.utils.addChat("error",e.session.lang.loaded.commands.noperm,"x-gray"):void(self.role>=3||self.gRole>=3?isNaN(parseInt(o))?e.utils.addChat("error",e.session.lang.loaded.commands.error,"chat-system"):API.getDJ().id!=n.id&&(-1!=API.getWaitListPosition(t.id)?API.moderateMoveDJ(t.id,parseInt(o)):(API.moderateAddDJ(t.id),setTimeout(function(){API.moderateMoveDJ(t.id,parseInt(o))},500))):e.utils.addChat("error",e.session.lang.loaded.commands.error,"chat-system"))})},add:function(t,s){var o=s.join(" ").substr(1),n=e.utils.isLocked(),i=API.getUser(),a=API.getDJ();e.utils.getUser(o,function(t){return null==t?e.utils.addChat("error",e.session.lang.loaded.commands.error,"chat-system"):void((i.role>=2||i.gRole>=3)&&a&&a.id!=t.id?n&&i.role>=3?API.moderateAddDJ(t.id):n&&i.role<3?e.utils.addChat("error",e.session.lang.loaded.commands.noperm,"x-gray"):n||API.moderateAddDJ(t.id):e.utils.addChat("error",e.session.lang.loaded.commands.noperm,"x-gray"))})},remove:function(t,s){var o=API.getUser(),n=s.join(" ").substr(1),i=API.getDJ();e.utils.getUser(n,function(t){return null==t?e.utils.addChat("error",e.session.lang.loaded.commands.error,"chat-system"):void(i&&-1!=API.getWaitListPosition(t)&&(o.role>=1||o.gRole>=3)&&e.utils.ajax("BOOTH/REMOVE/"+t.id,"DELETE"))})},skip:function(t,s){var o=API.getUser(),n=API.getDJ();o.role>=2||o.gRole>=3?n&&5!=n.gRole&&API.moderateForceSkip(n.id):e.utils.addChat("error",e.session.lang.loaded.commands.noperm,"x-gray")},ban:function(t,s){var o=API.getUser(),n=s.join(" ").substr(1);e.utils.getUser(n,function(t){return console.log(t),null==t?e.utils.addChat("error",e.session.lang.loaded.commands.error,"chat-system"):void((o.role>=3||o.gRole>=3)&&e.utils.ajax("BANS/ADD","POST",{userID:t.id,reason:1,duration:"f"}))})},kick:function(t,s){if(!(s.length<2)){1==s.length&&s.push("day");var o=API.getUser(),n="hour"==s.pop().toLowerCase()?"h":"d",i=s.join(" ").replace("@","");e.utils.getUser(i,function(t){return null==t?e.utils.addChat("error",e.session.lang.loaded.commands.error,"chat-system"):void((o.role>=2||o.gRole>=3)&&e.utils.ajax("BANS/ADD","POST",{userID:t.id,reason:1,duration:n}))})}},clearchat:function(t,s){var o=API.getUser(),n=$("#chat-messages > .cm[data-cid]");if(o.role>=2||o.gRole>=3)for(var i=0;i<n.length;i++){var a=n[i].getAttribute("data-cid");a&&-1==a.indexOf("phash")&&e.utils.deleteChat(a),i==n.length-1&&API.sendChat("/em [/clearchat] "+(e.session.lang.loaded.commands.clearchat?e.session.lang.loaded.commands.clearchat:"Chat cleared"))}else e.utils.addChat("error",e.session.lang.loaded.commands.noperm,"x-gray")},"delete":function(t,s){var o=API.getUser(),n=s.join(" ").replace("@",""),i=$(".cm.message").filter(function(e,t){return $(t).find(".un").text()==n});if(o.role>=2||o.gRole>=3)for(var a=0;a<i.length;a++){var l=i[a].getAttribute("data-cid").split("-");e.utils.getUser(n,function(t){l[0]==t.id&&e.utils.deleteChat(l.join("-")),a==i.length-1&&API.sendChat("/em [/delete @"+t.username+"] "+(e.session.lang.loaded.commands["delete"]?e.session.lang.loaded.commands["delete"]:"Deleted ."))})}else e.utils.addChat("error",e.session.lang.loaded.commands.noperm,"x-gray")},whois:function(t,s){if(0!=s.length){var o=s.join(" ");"@"==o.charAt(0)&&(o=o.substr(1)),e.utils.getUser(o,function(t){if(!t)return console.log("Failed to get user");console.log(t);var s=API.getWaitListPosition(t.id),o="ID: "+t.id+"<br>Joined: "+new Date(t.joined).toLocaleString()+" UTC<br>Level: "+t.level+"<br>Language: "+t.language+"<br>WaitList spot: "+(-1==s?"Not in WaitList":s+1)+"<br>"+(t.slug?'Profile: <a href="https://plug.dj/@/'+t.slug+'" target="_blank">Click here</a>':"");e.utils.addChat("success",o,"filter",t)})}},link:function(t,s){var o=API.getDJ(),n=API.getMedia();o&&(2==n.format?SC.get("/tracks/"+n.cid,function(t){e.utils.addChat("log",'<a href="'+t.permalink_url+'" target="_blank">'+n.author+" - "+n.title+"</a>","filter");
}):e.utils.addChat("log",'<a href="https://youtu.be/'+n.cid+'" target="_blank">'+n.author+" - "+n.title+"</a>","filter"))},reload:function(t,s){$.getScript(e.consts.links.plugHash),e.kill()},kill:function(t,s){e.kill()}},events:{API:{_advance:function(t){if(t.media&&(e.settings.voting.autoWoot&&e.utils.votes.woot(),e.settings.voting.autoMeh&&e.utils.votes.meh(),e.settings.voting.autoGrab&&e.utils.votes.grab(e.settings.voting.silentGrab)),t.lastPlay){var s=API.getUser();s&&t.lastPlay.dj&&t.lastPlay.dj.id==s.id&&e.settings.autoLeave&&(e.session.autoLeave.played++,e.settings.autoLeavePos===e.session.autoLeave.played&&(e.session.autoLeave.played=0,e.settings.autoJoin&&$("#autoJoin").click(),API.djLeave(),$("#autoLeave").click()))}e.ui.voteRollover.updvote()},advance:function(t){e.session.dj=t.dj,$("#yt-frame").attr("allowfullscreen","")},voteUpdate:function(t){e.ui.voteRollover.vote(t),e.settings.notifications.currentSong.woot&&1==t.vote?e.utils.addChat("woot",e.session.lang.loaded.notifications.user.userWooted,"woot",t.user):e.settings.notifications.currentSong.meh&&-1==t.vote&&e.utils.addChat("meh",e.session.lang.loaded.notifications.user.userMehd,"meh",t.user)},userJoin:function(t){e.settings.notifications.join.user&&e.utils.addChat("userJoined",e.session.lang.loaded.notifications.user.userJoined,"community-users",t)},_userLeave:function(t){if(e.settings.notifications.leave.user){var s=e.session.lang.loaded.notifications.user,o=e.session.waitList.filter(function(e){return e.id==t.id})[0],n=e.session.waitList.indexOf(o),i=e.session.dj,a=n>0||i&&i.id==t.id,l=a?s.userDC+(n>0?n:"DJ"):s.userLeft;e.utils.addChat("userLeft",l,"community-users",t)}},userLeave:function(t){e.settings.notifications.leave.user},guestJoin:function(t){e.settings.notifications.join.user&&e.utils.addChat("userJoined",e.session.lang.loaded.notifications.guestJoin,"users-white")},guestLeave:function(t){e.settings.notifications.leave.user&&e.utils.addChat("userLeft",e.session.lang.loaded.notifications.guestLeave,"users-white")},grabUpdate:function(t){if(e.settings.notifications.currentSong.grab){var s=API.getMedia();2==s.format?SC.get("/tracks/"+s.cid,function(o){e.utils.addChat("userGrabbed",e.session.lang.loaded.notifications.user.userGrabbed+'<br /><a href="'+o.permalink_url+'" target="_blank">'+s.author+" - "+s.title+"</a>","grab",t.user)}):e.utils.addChat("userGrabbed",e.session.lang.loaded.notifications.user.userGrabbed+'<br /><a href="https://youtu.be/'+s.cid+'" target="_blank">'+s.author+" - "+s.title+"</a>","grab",t.user)}},waitListUpdate:function(t){e.session.waitList=t},chatCommand:function(t){var s=t.substr(1).trim().split(" "),o=s.shift().toLowerCase();e.commands.hasOwnProperty(o)&&"function"==typeof e.commands[o]&&e.commands[o](t,s)}},modules:{lockedChange:function(){e.events.modules.waitListChange()},waitListChange:function(){e.settings.autoJoin&&e.events.modules.utils.joinBooth()},changeGuests:function(e){var t=e.previousAttributes().guests,s=e.changedAttributes().guests;s>t&&API.trigger("guestJoin",s),t>s&&API.trigger("guestLeave",s)},beforeChat:function(t){e.settings.chatMentions&&e.settings.chatMentionsArray.length>0&&e.utils.customMention(t),e.settings.customEmotes&&e.utils.emotes.replaceEmotes(t)},afterChat:function(t){var s=$('div[data-cid="'+t.cid+'"]');e.ui.addDeleteButton(t);var o=API.getUser(t.uid),n=o&&Math.max(o.role,o.gRole)>2;if(e.settings.afkEnabled&&n&&t.message.match(/^!afkdisable/i)&&($("#afkMessage").click(),API.sendChat("@"+t.un+" AFK Message disabled"),e.utils.addChat("log",t.un+e.session.lang.loaded.commands.afkDisable,"unignore")),e.settings.autoJoin&&n&&t.message.match(/^!joindisable/i)&&($("#autoJoin").click(),API.sendChat("@"+t.un+" Auto Join disabled"),e.utils.addChat("log",t.un+e.session.lang.loaded.commands.joinDisable,"join-waitlist")),e.settings.afkEnabled){var i=(new Date).getTime(),a=API.getUser(),l=i>e.session.afkMessage.chat.lastSent+3e5&&a&&-1!=t.message.indexOf("@"+a.username);l&&API.sendChat("[AFK] @"+t.un+" "+(e.settings.afkMessage||e.session.lang.loaded.settings.afkMessageDefault)),(l||a&&t.uid==a.id)&&(e.session.afkMessage.chat.lastSent=i)}if(s.length){for(var u=e.utils.team.getRole(t.uid).reverse(),r=s.find(".from");u.length>0&&r.length>0;)r.prepend('<i class="icon rank rank-'+u.pop()+'"></i>');s.addClass("communityRole-"+e.consts.plugRoles[o.role])}},roomJoined:function(){var t=API.getUser().vote;e.settings.voting.autoWoot&&0==t&&e.utils.votes.woot(),e.settings.voting.autoMeh&&0==t&&e.utils.votes.meh(),e.settings.voting.autoGrab&&e.utils.votes.grab(e.settings.voting.silentGrab),e.settings.autoJoin&&e.events.modules.utils.joinBooth(),e.session.dj=API.getDJ,e.session.waitList=API.getWaitList(),e.session.autoLeave.played=0,e.ui.voteRollover.updvote()},mediaChange:function(t){e.modules.media&&e.modules.media.set("remaining",e.modules.media.get("duration")-e.modules.media.get("elapsed"))},mediaChangeRemaining:function(t){0==API.getUser().vote&&e.settings.voting.reverseWoot&&10==t.changedAttributes().remaining&&e.utils.votes.woot(!0)},userRolloverChange:function(t,s,o){var n=e.modules.rollover,i=n.user;if(n._showSimple(t,s,o),i!==t){var a=API.getUser();a.gRole||n.$meta.hasClass("user-id")||(n.$meta.addClass("has-id"),n.$meta.has(".user-id").length||n.$meta.append('<span class="user-id"></span>'),n.$meta.find(".user-id").text(e.session.lang.loaded.misc.rolloverID+t.get("id"))),n.$meta.find('i[class*="rank rank-"]').remove();for(var l=e.utils.team.getRole(t.get("id"));l.length>0;)n.$meta.find(".status").prepend('<i class="icon rank rank-'+l.pop()+'"></i>')}},utils:{canUserJoin:function(){if(null==e.modules.booth||null==e.modules.waitlist)return!1;var t=e.modules.booth.toJSON(),s=e.modules.waitlist,o=API.getUser();return o&&!s.isTheUserPlaying&&!s.isTheUserWaiting&&s.length<50&&((o.role>0||o.gRole)&&t.isLocked||!t.isLocked)},joinBooth:function(){this.canUserJoin&&API.djJoin()}}},ui:{resize:function(){e.ui.voteRollover.resize()}}},modules:{require:null,media:null,events:null,user:null,users:null,rollover:null,settings:null,compress:null,booth:null,room:null,score:null,urls:null,emojis:null,playlists:null,waitlist:null,lang:null,util:null,chat:null,utils:{chat:{chat:null,resetType:function(){var t=e.modules.chat;return t&&t.chatView&&(t.chatView.lastType=null)}},playlists:{getActive:function(){return this.get(e.modules.playlists.getActiveID())},get:function(t){var s=e.modules.playlists.get(t);return s?s.toJSON():null},getAll:function(){return e.modules.playlists.toJSON()}}},init:function(){this.require=require.s.contexts._.defined;var e=Object.keys(this.require);for(var t in e)if(!("object"!=typeof this.require[e[t]]&&"function"!=typeof this.require[e[t]]||!Object.keys(this.require[e[t]]).length||Object.keys(this.require[e[t]]).length<1)){var s=this.require[e[t]];this.waitlist=null!=s.isTheUserWaiting?s:this.waitlist,this.events=s._events&&s._events["chat:receive"]?s:this.events,this.media=s.attributes&&s.attributes.media?s:this.media,this.booth=s.attributes&&null!=s.attributes.waitingDJs?s:this.booth,this.user=s.attributes&&null!=s.attributes.username?s:this.user,this.room=s.attributes&&null!=s.attributes.joinTime?s:this.room,this.users=s._events&&null!=s._events["change:avatarID"]?s:this.users,this.score=s._events&&null!=s._events["change:positive"]?s:this.score,this.playlists="undefined"!=typeof s.activeMedia?s:this.playlists,this.urls="undefined"!=typeof s.scThumbnail?s:this.urls,this.emojis="undefined"!=typeof s.replace_colons?s:this.emojis,this.compress=s.decompressFromUTF16&&s.compressToUTF16?s:this.compress,this.rollover=s.el&&"user-rollover"==s.el.id?s:this.rollover,this.settings=s.settings?s:this.settings,this.util=s.isorx?s:this.util,this.chat=s.chatView?s:this.chat}this.lang=this.require["lang/Lang"]}},storage:{save:function(){e.settings.version=e.consts.version,localStorage.phash=JSON.stringify(e.settings)},load:function(){try{var t=JSON.parse(localStorage.phash);e.settings.version=e.consts.version,e.settings=$.extend({},e.settings,t)}catch(s){}}},init:function(){window.pHash=!0,e.storage.load(),e.modules.init(),e.utils.team.loadTeam();var t=e.settings.lang||API.getUser().language||e.settings.defaultLang;e.utils.loadLang(t,function(s){e.session.lang.language=t,e.session.dj=API.getDJ(),e.session.currentUser=API.getUser(),e.loadEvents(),e.ui.loadUI(),e.ui.loadCSS(e.consts.links.css),e.utils.emotes.getEmotes();var o=e.modules.utils.playlists.getActive();e.settings.voting.grabTo=o?o.id:null,e.events.modules.roomJoined();var n=e.consts.version.string+" "+e.session.lang.loaded.running;e.utils.addSpecial("hash",n,"rank rank-hash")}),"undefined"==typeof API._dispatch&&(API._dispatch=API.dispatch,API.dispatch=function(e,t){API.trigger("_"+e,t),API._dispatch(e,t)}),"undefined"==typeof RegExp.escape&&(RegExp.escape=function(e){return e.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&")})},kill:function(){e.modules.events.trigger("tooltip:hide"),e.stopEvents(),e.ui.unloadCSS(),e.ui.unloadUI(),e.utils.addChat("log",e.session.lang.loaded.killmsg,"dialog-close"),window.pHash=!1,e=void 0},loadEvents:function(){API.on(e.events.API);var t=e.modules;null!=t.booth&&(t.booth.on("change:isLocked",e.events.modules.lockedChange),t.booth.on("change:waitingDJs",e.events.modules.waitListChange)),null!=t.room&&t.room.on("change:guests",e.events.modules.changeGuests),null!=t.events&&(t.events.on("chat:receive",e.events.modules.beforeChat),t.events._events["chat:receive"].unshift(e.modules.events._events["chat:receive"].pop()),t.events.on("chat:receive",e.events.modules.afterChat),t.events.on("room:joined",e.events.modules.roomJoined)),null!=t.media&&(t.media.on("change:media",e.events.modules.mediaChange),t.media.on("change:remaining",e.events.modules.mediaChangeRemaining)),t.rollover._showSimple=t.rollover.showSimple,t.rollover.showSimple=e.events.modules.userRolloverChange},stopEvents:function(){API.off(e.events.API);var t=e.modules;null!=t.booth&&(t.booth.off("change:isLocked",e.events.modules.lockedChange),t.booth.off("change:waitingDJs",e.events.modules.waitListChange)),null!=t.room&&t.room.off("change:guests",e.events.modules.changeGuests),null!=t.events&&(t.events.off("chat:receive",e.events.modules.beforeChat),t.events.off("chat:receive",e.events.modules.afterChat),t.events.off("room:joined",e.events.modules.roomJoined)),null!=t.media&&(t.media.off("change:media",e.events.modules.mediaChange),t.media.off("change:remaining",e.events.modules.mediaChangeRemaining)),t.rollover.showSimple=t.rollover._showSimple,delete t.rollover._showSimple}};e.init()}();
