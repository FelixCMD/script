if(!window.pHash&&"undefined"!=typeof window.API&&API.getUser()){var plugHash={consts:{version:{major:0,minor:1,label:"alpha"},minSettingsVersion:{major:0,minor:1,label:"alpha"},links:{plugHash:"https://rawgit.com/plughash/script/master/plughash.min.js",baseURL:"https://rawgit.com/plughash/script/master/",langs:"",team:null,theme:null,css:"dark-UICSS",emotes:{plughash:"assets/json/emotes.json"}},plugRoles:{5:"host",4:"cohost",3:"manager",2:"bouncer",1:"residentdj",0:"none"}},settings:{expanded:!1,autoJoin:!1,autoLeave:!1,autoLeavePos:null,autoLeaveValue:5,afkEnabled:!1,afkMessage:null,accidentalNavigation:!1,defaultLang:"en",lang:null,chatImagesMaxSize:null,chatMentions:!1,chatMentionsArray:["plug#"],customEmotes:!0,videoHidden:!1,videoFullscreen:!1,voting:{autoWoot:!0,reverseWoot:!1,autoMeh:!1,autoGrab:!1,silentGrab:!1,grabTo:null},customization:{legacyChat:!1,legacyFooter:!1,customMentionSound:null,background:null,chatColors:{admin:null,ba:null,host:null,cohost:null,manager:null,bouncer:null,rdj:null,subscriberGold:null,subscriberSilver:null,friend:null,user:null,self:null,banned:null},defaultColors:{admin:"#42A5DC",ba:"#89be6c",host:"#ac76ff",cohost:"#ac76ff",manager:"#ac76ff",bouncer:"#ac76ff",rdj:"#ac76ff",subscriberGold:"#c59840",subscriberSilver:"#8694b2",friend:"#777F92",user:"#777F92",self:"#FFDD6F",banned:"#C42E3B"}},staffTools:{chatLog:!1,deletedChat:!1,historyAlert:!1,durationAlert:!1,durationAlertLength:null},inlinePreviews:{images:!1,gifs:!1,videos:!1,audio:!1},emotes:{plughash:null,twitch:null,betterttv:null},notifications:{desktopNotifications:!1,join:{all:!1,admin:!1,ba:!1,staff:{host:!1,cohost:!1,manager:!1,bouncer:!1,rdj:!1},subscriberGold:!1,sinscronerSilver:!1,friend:!1,lvl1:!1,user:!1,guest:!1},leave:{all:!1,admin:!1,ba:!1,staff:{host:!1,cohost:!1,manager:!1,bouncer:!1,rdj:!1},subscriberGold:!1,sinscronerSilver:!1,friend:!1,lvl1:!1,user:!1,guest:!1},advance:{lastSong:!1,currentSong:!1,boothAlert:!1,boothAlertPos:null},currentSong:{woot:!1,grab:!1,meh:!1}}},session:{timeout:{},interval:{},afkMessage:{chat:{lastSent:0},"private":{}},waitList:[],dj:null,currentUser:null,lang:{list:null,loaded:null,language:"en"},emotes:{plugHash:null},autoLeave:{played:0},voteRollover:{vote:null},team:{}},ui:{buttons:[{type:"autoTools",description:"...",icon:"icon icon-join-waitlist",role:0,settingsValue:function(){return""},action:function(){var s=$(".plughash-MENU > .buttons-autoTasks"),e=s.hasClass("expanded");e?s.animate({left:"-=300px"},"fast").removeClass("expanded"):s.animate({left:"+=300px"},"fast").addClass("expanded")}},{type:"autoWoot",description:"...",icon:"icon icon-woot-disabled",subMenu:"autoTasks",role:0,tooltip:function(){return plugHash.session.lang.loaded.settings.autoWoot},settingsValue:function(){return plugHash.settings.voting.autoWoot?"":"disabled"},action:function(){var s=plugHash.session.lang.loaded;plugHash.settings.voting.autoWoot=!plugHash.settings.voting.autoWoot;var e=s.settings.autoWoot+" "+(plugHash.settings.voting.autoWoot?s.misc.enabled:s.misc.disabled);plugHash.utils.addChat("log",e,"woot-disabled"),plugHash.utils.votes.woot()}},{type:"autoJoin",description:"...",icon:"icon icon-join-waitlist",subMenu:"autoTasks",role:0,tooltip:function(){return plugHash.session.lang.loaded.settings.autoJoin},settingsValue:function(){return plugHash.settings.autoJoin?"":"disabled"},action:function(){var s=plugHash.session.lang.loaded;plugHash.settings.autoJoin=!plugHash.settings.autoJoin;var e=s.settings.autoJoin+" "+(plugHash.settings.autoJoin?s.misc.enabled:s.misc.disabled);plugHash.utils.addChat("log",e,"join-waitlist"),plugHash.events.modules.utils.joinBooth()}},{type:"autoLeave",description:"...",icon:"icon icon-leave-waitlist",subMenu:"autoTasks",role:0,tooltip:function(){return plugHash.session.lang.loaded.settings.autoLeave},settingsValue:function(){return plugHash.settings.autoLeave?"":"disabled"},action:function(){var s=plugHash.session.lang.loaded;plugHash.settings.autoLeave=!plugHash.settings.autoLeave;var e=s.settings.autoLeave+" "+(plugHash.settings.autoLeave?s.misc.enabled:s.misc.disabled);plugHash.utils.addChat("log",e,"join-waitlist")}},{type:"autoGrab",description:"...",icon:"icon icon-grab-disabled",subMenu:"autoTasks",role:0,tooltip:function(){return plugHash.session.lang.loaded.settings.autoGrab},settingsValue:function(){return plugHash.settings.voting.autoGrab?"":"disabled"},action:function(){var s=plugHash.session.lang.loaded;plugHash.settings.voting.autoGrab=!plugHash.settings.voting.autoGrab;var e=s.settings.autoGrab+" "+(plugHash.settings.voting.autoGrab?s.misc.enabled:s.misc.disabled);plugHash.utils.addChat("log",e,"grab-disabled"),plugHash.utils.votes.grab(plugHash.settings.voting.silentGrab)}},{type:"reverseWoot",description:"...",icon:"icon icon-woot-disabled",role:0,settingsValue:function(){return plugHash.settings.voting.reverseWoot?"":"disabled"},action:function(){var s=plugHash.session.lang.loaded;plugHash.settings.voting.reverseWoot=!plugHash.settings.voting.reverseWoot;var e=s.settings.reverseWoot+" "+(plugHash.settings.voting.reverseWoot?s.misc.enabled:s.misc.disabled);plugHash.utils.addChat("log",e,"woot-disabled")}},{type:"silentGrab",description:"...",icon:"icon icon-grab-disabled",role:0,settingsValue:function(){return plugHash.settings.voting.silentGrab?"":"disabled"},action:function(){var s=plugHash.session.lang.loaded;plugHash.settings.voting.silentGrab=!plugHash.settings.voting.silentGrab;var e=s.settings.silentGrab+" "+(plugHash.settings.voting.silentGrab?s.misc.enabled:s.misc.disabled);plugHash.utils.addChat("log",e,"grab-disabled"),plugHash.settings.voting.autoGrab&&plugHash.utils.votes.grab(plugHash.settings.voting.silentGrab)}},{type:"chatNotifications",description:"...",icon:"icon icon-ignore",role:0,settingsValue:function(){return""},action:function(){var s=$(".plughash-MENU > .buttons-notifications"),e=s.hasClass("expanded");e?s.animate({left:"-=300px"},"fast").removeClass("expanded"):s.animate({left:"+=300px"},"fast").addClass("expanded")}},{type:"userWoots",description:"...",icon:"icon icon-woot",subMenu:"notifications",role:0,tooltip:function(){return plugHash.session.lang.loaded.notifications.user.userWoots},settingsValue:function(){return plugHash.settings.notifications.currentSong.woot?"":"disabled"},action:function(){var s=plugHash.session.lang.loaded;plugHash.settings.notifications.currentSong.woot=!plugHash.settings.notifications.currentSong.woot;var e=s.notifications.user.userWoots+" "+(plugHash.settings.notifications.currentSong.woot?s.misc.enabled:s.misc.disabled);plugHash.utils.addChat("log",e,"woot")}},{type:"userMehs",description:"...",icon:"icon icon-meh",subMenu:"notifications",role:0,tooltip:function(){return plugHash.session.lang.loaded.notifications.user.userMehs},settingsValue:function(){return plugHash.settings.notifications.currentSong.meh?"":"disabled"},action:function(){var s=plugHash.session.lang.loaded;plugHash.settings.notifications.currentSong.meh=!plugHash.settings.notifications.currentSong.meh;var e=s.notifications.user.userMehs+" "+(plugHash.settings.notifications.currentSong.meh?s.misc.enabled:s.misc.disabled);plugHash.utils.addChat("log",e,"meh")}},{type:"userGrabs",description:"...",icon:"icon icon-grab",subMenu:"notifications",role:0,tooltip:function(){return plugHash.session.lang.loaded.notifications.user.userGrabs},settingsValue:function(){return plugHash.settings.notifications.currentSong.grab?"":"disabled"},action:function(){var s=plugHash.session.lang.loaded;plugHash.settings.notifications.currentSong.grab=!plugHash.settings.notifications.currentSong.grab;var e=s.notifications.user.userGrabs+" "+(plugHash.settings.notifications.currentSong.grab?s.misc.enabled:s.misc.disabled);plugHash.utils.addChat("log",e,"grab")}},{type:"userJoin",description:"...",icon:"icon icon-community-users",subMenu:"notifications",role:0,tooltip:function(){return plugHash.session.lang.loaded.notifications.user.userJoin},settingsValue:function(){return plugHash.settings.notifications.join.user?"":"disabled"},action:function(){var s=plugHash.session.lang.loaded;plugHash.settings.notifications.join.user=!plugHash.settings.notifications.join.user;var e=s.notifications.user.userJoin+" "+(plugHash.settings.notifications.join.user?s.misc.enabled:s.misc.disabled);plugHash.utils.addChat("log",e,"community-users")}},{type:"userLeave",description:"...",icon:"icon icon-ban",subMenu:"notifications",role:0,tooltip:function(){return plugHash.session.lang.loaded.notifications.user.userLeave},settingsValue:function(){return plugHash.settings.notifications.leave.user?"":"disabled"},action:function(){var s=plugHash.session.lang.loaded;plugHash.settings.notifications.leave.user=!plugHash.settings.notifications.leave.user;var e=s.notifications.user.userLeave+" "+(plugHash.settings.notifications.leave.user?s.misc.enabled:s.misc.disabled);plugHash.utils.addChat("log",e,"community-users")}},{type:"afkMessage",description:"...",icon:"icon icon-unignore",role:0,settingsValue:function(){return plugHash.settings.afkEnabled?"":"disabled"},action:function(){var s=plugHash.session.lang.loaded;plugHash.settings.afkEnabled=!plugHash.settings.afkEnabled;var e=s.settings.afkMessage+" "+(plugHash.settings.afkEnabled?s.misc.enabled:s.misc.disabled);plugHash.utils.addChat("log",e,"unignore")}},{type:"customMentions",description:"...",icon:"icon icon-mention",role:0,settingsValue:function(){return plugHash.settings.chatMentions?"":"disabled"},action:function(){var s=plugHash.session.lang.loaded;plugHash.settings.chatMentions=!plugHash.settings.chatMentions;var e=s.settings.customMentions+" "+(plugHash.settings.chatMentions?s.misc.enabled:s.misc.disabled);plugHash.utils.addChat("log",e,"mention")}},{type:"customEmotes",description:"...",icon:"icon icon-emoji-on",role:0,settingsValue:function(){return plugHash.settings.customEmotes?"":"disabled"},action:function(){var s=plugHash.session.lang.loaded;plugHash.settings.customEmotes=!plugHash.settings.customEmotes;var e=s.settings.customEmotes+" "+(plugHash.settings.customEmotes?s.misc.enabled:s.misc.disabled);plugHash.utils.addChat("log",e,"emoji-on")}},{type:"kill",description:"...",icon:"icon icon-dialog-close",role:0,settingsValue:function(){return""},action:function(){plugHash.kill()}}],loadUI:function(){var s=plugHash.session.lang.loaded;$("body").append('<div id="plughash-UI"></div>'),$("#plughash-UI").append('<div class="plughash-MENU"><button type="button" id="expand-menu" class="expand button" data-tooltip="Hide/Show Menu"><i class="icon icon-swap"></i></button><div id="button-options" class="expanded buttons"></div><div id="button-notifications" class="buttons-notifications"></div><div id="button-autoTasks" class="buttons-autoTasks"></div></div>'),$.each(plugHash.ui.buttons,function(e,t){(t.role<=API.getUser().role||t.role<=API.getUser().gRole)&&($(t.subMenu?"#button-"+t.subMenu:"#button-options").append('<button type="button" id="'+t.type+'" data-tooltip="'+(t.tooltip?t.tooltip():s.settings[t.type])+'" class="'+(t.subMenu?t.subMenu+" ":"")+t.type+" button "+t.settingsValue()+'"><i class="'+t.icon+'"></i></button>'),$("#"+t.type).on("click",function(){t.action(),$(this).hasClass("disabled")?$(this).removeClass("disabled"):$(this).addClass("disabled"),plugHash&&plugHash.storage.save()}))}),$("#expand-menu").on("click",function(){var s=$(".plughash-MENU > .buttons"),e=$(".plughash-MENU > .buttons-notifications"),t=$(".plughash-MENU > .buttons-autoTasks"),a=($(".plughash-MENU .expand.button"),e.hasClass("expanded")),o=t.hasClass("expanded"),n=s.hasClass("expanded");n?(s.animate({left:"-=50px"},"fast").removeClass("expanded"),plugHash.settings.expanded=!1,a&&o?($("#chatNotifications").click(),$("#autoTools").click()):o?$("#autoTools").click():a&&$("#chatNotifications").click()):(s.animate({left:"+=50px"},"fast").addClass("expanded"),plugHash.settings.expanded=!0,a&&o?($("#chatNotifications").click(),$("#autoTools").click()):o?$("#autoTools").click():a&&$("#chatNotifications").click())}),$(".app-view").append('<div class="pop-menu vote" style="height: 234px; left: 668px; top: 268px; display: none"><div class="bar">									<i class="icon icon-grab-disabled"></i><span class="title"></span><div class="bar-divider"></div></div>									<div class="menu" style="height: 186px;"><ul></ul></div></div>'),$(".pop-menu.vote").on("mouseout",plugHash.ui.voteRollover.voteMouseLeave).on("mouseover",function(){$(this).show()}),$("#app").on("mouseout",plugHash.ui.voteRollover.voteMouseLeave),$("#woot, #grab, #meh").on("mouseover",plugHash.ui.voteRollover.mouseOver),$("#vote").on("mouseover",plugHash.ui.voteRollover.voteMouseOver),plugHash.ui.voteRollover.resize(),$(window).resize(plugHash.events.ui.resize),$(document).on("click",".pop-menu.vote li",plugHash.ui.voteRollover.userSelected),$("#button-options button").on("mouseover",plugHash.ui.tooltip.show),$("#button-options button").on("mouseout",plugHash.ui.tooltip.hide),$("#button-notifications button").on("mouseover",plugHash.ui.tooltip.show),$("#button-notifications button").on("mouseout",plugHash.ui.tooltip.hide),$("#button-autoTasks button").on("mouseover",plugHash.ui.tooltip.show),$("#button-autoTasks button").on("mouseout",plugHash.ui.tooltip.hide),$(document).on("mouseover",".rank",plugHash.ui.roles.showTooltip),$(document).on("mouseout",".rank",plugHash.ui.roles.hideTooltip)},unloadUI:function(){$("#plughash-UI").remove(),$("#app").off("mouseout",plugHash.ui.voteRollover.voteMouseLeave),$(".pop-menu.vote").off().remove(),$("#woot, #grab, #meh").off("mouseover",plugHash.ui.voteRollover.mouseOver),$("#vote").off("mouseover",plugHash.ui.voteRollover.voteMouseOver),$("#button-options button").off("mouseover",plugHash.ui.tooltip.show),$("#button-options button").off("mouseout",plugHash.ui.tooltip.hide),$("#button-notifications button").off("mouseover",plugHash.ui.tooltip.show),$("#button-notifications button").off("mouseout",plugHash.ui.tooltip.hide),$("#button-autoTasks button").off("mouseover",plugHash.ui.tooltip.show),$("#button-autoTasks button").off("mouseout",plugHash.ui.tooltip.hide),$(window).off("resize",plugHash.events.ui.resize),$(document).off("click",".pop-menu.vote li",plugHash.ui.voteRollover.userSelected),$(document).off("mouseover",".rank",plugHash.ui.roles.showTooltip),$(document).off("mouseout",".rank",plugHash.ui.roles.hideTooltip);var s=API.getUser(),e=plugHash.modules.rollover;s.gRole||(e.$meta.removeClass(".has-id"),e.$meta.find(".user-id").remove()),plugHash.modules.rollover.$meta.find('i[class*="rank rank-"]').remove(),$('i[class*="rank rank-"]').remove()},loadCSS:function(s){switch(s||""){case"dark-THEMECSS":case"white-THEMECSS":case"pink-THEMECSS":$("head").append('<link id="phash-UICSS" rel="stylesheet" type="text/css" href="'+plugHash.consts.links.baseURL+"assets/css/"+s+'.css" />');break;case"dark-UICSS":case"white-UICSS":case"pink-UICSS":$("head").append('<link id="phash-THEMECSS" rel="stylesheet" type="text/css" href="'+plugHash.consts.links.baseURL+"assets/css/"+s+'.css" />');break;default:s?$("head").append('<link id="phash-THEMECSS" rel="stylesheet" type="text/css" href="'+s+'" />'):$("head").append('<link id="phash-UICSS" rel="stylesheet" type="text/css" href="'+plugHash.consts.links.css+'" />')}},unloadCSS:function(){$("#phash-UICSS").remove(),$("#phash-THEMECSS").remove()},addDeleteButton:function(s){var e=API.getUser();if(e&&e.id==s.uid&&!(Math.max(e.role,e.gRole)<2)){var t=$('div[data-cid^="'+s.cid+'"]').last();if(t.length){var a=plugHash.modules.lang.chat["delete"];t.append('<div class="delete-button">'+a+"</div>"),t.hover(function(){return $(this).find(".delete-button").css("display","block")}),t.mouseleave(function(){return $(this).find(".delete-button").css("display","none")}),t.find(".delete-button").on("click",function(){plugHash.utils.ajax("CHAT/"+s.cid,"DELETE")})}}},getUserIcon:function(s){if(s.gRole)return s.gRole<5?"ambassador":"admin";if(0==s.role){if(s.sub)return"subscriber";if(s.silver)return"silver-subscriber"}return 5==s.role||4==s.role?"host":3==s.role?"manager":2==s.role?"bouncer":1==s.role?"dj":""},voteRollover:{resize:function(s){var e={left:0,top:0},t=null,a=$(document),o=a.find("#vote"),n=a.find(".pop-menu"),i=parseInt(n.css("width").match(/\d{1,}/)[0]),l=parseInt(o.css("width").match(/\d{1,}/)[0]),t=o;if(a.find("#video-only-dj").length||a.find(".popout").length){switch(plugHash.session.voteRollover.vote){case-1:t=a.find("#meh");break;case 0:t=a.find("#grab");break;default:t=a.find("#woot")}var u=parseInt(t.css("width").match(/\d{1,}/)[0]),r=i-u,g=(parseInt(t.css("width").match(/\d{1,}/)[0]),o.offset());e.left=t.offset().left-r/2,g.left+l<e.left+i&&(e.left=g.left+l-i)}else{var u=parseInt(t.css("width").match(/\d{1,}/)[0]),r=i-u;e.left=t.offset().left-r/2}e.left<0&&(e.left=0),e.top=t.offset().top-234,e.left=e.left+"px",e.top=e.top+"px",a.find(".pop-menu.vote").css(e)},mouseOver:function(){plugHash.ui.voteRollover.list($(this).attr("id"))},voteMouseOver:function(){plugHash.ui.voteRollover.resize(),$(this).parents().last().find(".pop-menu.vote").show()},voteMouseLeave:function(){$(this).parents().last().find(".pop-menu.vote").hide(),plugHash.session.voteRollover.vote=null},vote:function(s){plugHash.session.voteRollover.vote==s.vote&&plugHash.ui.voteRollover.updvote(s.vote)},grab:function(s){0==plugHash.session.voteRollover.vote&&plugHash.ui.voteRollover.updvote(0)},updvote:function(){var s=API.getUsers().filter(function(s){return plugHash.session.voteRollover.vote?s.vote==plugHash.session.voteRollover.vote:s.grab}),e="",t="";for(var a in s)t=plugHash.ui.getUserIcon(s[a]),e+="<li>"+(t?'<i class="icon icon-chat-'+t+'"></i>':"")+'<span class="'+t+'">'+_.escape(s[a].username)+"</span></li>";var o=$(document);o.find(".pop-menu.vote .menu > ul").html(e)},list:function(s){var e="woot"==s?1:"meh"==s?-1:0;if(e!=plugHash.session.voteRollover.vote){plugHash.session.voteRollover.vote=e;var t=$(document);t.find(".pop-menu.vote .bar .icon").attr("class","icon icon-"+s+"-disabled"),t.find(".pop-menu.vote .bar .title").text(t.find("#"+s).find(".top .label").text()),plugHash.ui.voteRollover.updvote(plugHash.session.voteRollover.vote)}},userSelected:function(s){var e=plugHash.modules.users.findWhere({username:$(this).find("span").text()});e&&plugHash.modules.rollover.showChat(e,{x:s.pageX,y:s.pageY})}},tooltip:{show:function(s){var e=$(this);plugHash.modules.events.trigger("tooltip:show",s.currentTarget.attributes[2].value,e)},hide:function(s){var e=$(this);plugHash.modules.events.trigger("tooltip:hide",s.currentTarget.attributes[2].value,e)}},roles:{showTooltip:function(s){var e=($(this).attr("class").match(/rank-(.*)(\s|$)/)||[])[1];if(e){var t=plugHash.session.lang.loaded,a=t.plugHashRoles[e];if("rankwhore"==e){var o=t.plugHashRoles.whoreTitles;o.length&&(a=o[Math.round(100*Math.random()%(o.length-1))])}plugHash.modules.events.trigger("tooltip:show",a,$(this))}},hideTooltip:function(s){plugHash.modules.events.trigger("tooltip:hide")}}},utils:{addLog:function(s,e,t){$("#chat-messages")},addSpecial:function(s,e,t,a){var o=$("#chat-timestamp-button i").hasClass("icon-timestamps-24")?24:$("#chat-timestamp-button i").hasClass("icon-timestamps-12")?12:"off",n=(new Date).toTimeString().substr(0,5);n="0"==n.charAt(0)?n.substr(1):n,n=parseInt(n)>12?12==o?parseInt(n)-12+n.substr(2)+"pm":n:12==o?n+"am":n;var i={type:"phash special-"+(s?s:"log"),message:e||plugHash.session.lang.loaded.misc.msgerror,uid:a?a.id:13437704,un:a?a.username:"plug#",timestamp:n,cid:"phash-"+Math.floor(0x4bffe996c5d15*Math.random())};plugHash.modules.events.trigger("chat:receive",i),$("[data-cid="+i.cid+"] .badge-box").children().remove(),$("[data-cid="+i.cid+"] .badge-box").removeClass("no-badge"),$("[data-cid="+i.cid+"] .badge-box").append('<i class="'+t+'"></i>'),$("#chat-messages").scrollTop($("#chat-messages").prop("scrollHeight"))},addChat:function(s,e,t,a){var o=plugHash.modules.settings.settings.chatTimestamps,n=plugHash.modules.util.getChatTimestamp(24==o),i={type:"phash plughash-"+(s?s:"log"),message:e||plugHash.session.lang.loaded.misc.msgerror,uid:a?a.id:13437704,un:a?a.username:"plug#",timestamp:n,cid:"phash-"+Math.floor(0x4bffe996c5d15*Math.random())};plugHash.modules.events.trigger("chat:receive",i),$("[data-cid="+i.cid+"] .badge-box").children().remove(),$("[data-cid="+i.cid+"] .badge-box").removeClass("no-badge"),$("[data-cid="+i.cid+"] .badge-box").append('<i class="icon icon-'+t+'"></i>'),$("#chat-messages").scrollTop($("#chat-messages").prop("scrollHeight"))},customMention:function(s){var e=[],t=plugHash.settings.chatMentionsArray;for(var a in t)-1!=s.message.indexOf(t[a])&&-1==e.indexOf(t[a])&&e.push(t[a]);if(e.length){s.type="mention",s.sound="mention","undefined"==typeof s.mentions&&(s.mentions=[]);for(var a in e)-1==s.mentions.indexOf(e[a])&&(s.mentions.push(e[a]),s.message.replace(new RegExp(RegExp.escape(e[a]),"g"),'<span class="name">'+e[a]+"</span>"))}},getLangs:function(s){"function"==typeof s&&$.getJSON(plugHash.consts.links.baseURL+"assets/json/lang.json",function(e){plugHash.session.lang.list=e,s(e)})},loadLang:function(s,e){if("string"==typeof s&&"function"==typeof e){if(!plugHash.session.lang.list)return void this.getLangs(function(){plugHash.utils.loadLang(s,e)});plugHash.session.lang.list.hasOwnProperty(s)||(s=plugHash.settings.defaultLang),$.getJSON(plugHash.consts.links.baseURL+"assets/json/languages/"+s+".json",function(s){plugHash.session.lang.loaded=s,e(s)})}},replaceLang:function(s,e){return"string"!=typeof s?"[ERR] Invalid text":e&&"object"==typeof e?($.each(e,function(e,t){s=s.replace("%%"+e.toUpperCase()+"%%",t)}),s):s},team:{loadTeam:function(s){$.getJSON(plugHash.consts.links.baseURL+"assets/json/team.json",function(e){plugHash.session.team=e,"function"==typeof s&&s(e)})},getRole:function(s){var e=[];return plugHash.session.team?($.each(plugHash.session.team,function(t,a){-1!=a.users.indexOf(s)&&e.push(t)}),e):e}},emotes:{getEmotes:function(s){$.getJSON(plugHash.consts.links.baseURL+plugHash.consts.links.emotes.plughash,function(e){plugHash.session.emotes=e,"function"==typeof s&&s(e)})},replace:function(s,e,t){var a=s.message.match(/:(.*?):/g);a&&a.forEach(function(a){var o=a.slice(1,-1).toLowerCase();if(e.hasOwnProperty(o)){var n={url:e[o].hasOwnProperty("url")?e[o].url:e._template.url.replace("{code}",e[o]),width:e[o].hasOwnProperty("width")?e[o].width:e._template.width,height:e[o].hasOwnProperty("height")?e[o].height:e._template.height};s.message=s.message.replace(new RegExp(a,"gi"),function(s){return'<div class="custom-emote" title="&#58;'+o+'&#58;" style="background-image:url('+n.url+"); background-repeat: no-repeat; "+(t?"background-size: contain;":"")+" width:"+n.width+"; height:"+n.height+';"></div>'})}})},replaceEmotes:function(s){var e=$("#chat-messages"),t=e.scrollTop()>e[0].scrollHeight-e.height()-28;plugHash.session.emotes.plughash&&this.replace(s,plugHash.session.emotes.plughash),plugHash.session.emotes.twitch&&this.replace(s,plugHash.session.emotes.twitch,!0),t&&e.scrollTop(e[0].scrollHeight)}},ajax:function(s,e,t,a){var o=$.ajax({type:e||"GET",url:"/_/"+s.toLowerCase(),contentType:t?"application/json":void 0,data:t?JSON.stringify(t):void 0});"function"==typeof a&&(o.done(function(s){a(null,s)}),o.fail(function(s,e){a({jqXHR:s,textStatus:e})}))},deleteChat:function(s){plugHash.utils.ajax("chat/"+s,"DELETE")},getUser:function(s,e){if(isNaN(s)){var t=API.getUsers().filter(function(e){return e.username==s})[0]||null;if("function"!=typeof e)return t;e(t)}else"function"==typeof e&&plugHash.utils.ajax("USERS/"+s,"GET",void 0,function(s,t){return e(s?null:t.data[0])})},getPlaylist:function(s,e){plugHash.utils.ajax("PLAYLISTS/"+s+"/MEDIA","GET",void 0,function(s,t){return t=t.data,e(s?null:t)})},getPlaylists:function(s){plugHash.utils.ajax("PLAYLISTS","GET",void 0,function(e,t){return t=t.data,s(e?null:t)})},addToPlaylist:function(s,e,t,a){e.id=0,plugHash.utils.ajax("PLAYLISTS/"+s+"/MEDIA/INSERT","POST",{media:[e],append:t||!1},function(e,o){t&&!e&&o&&o.data&&plugHash.utils.getPlaylist(s,function(e){e&&e.length&&plugHash.utils.ajax("PLAYLISTS/"+s+"/MEDIA/MOVE","PUT",{ids:[e[0].id],beforeID:-1})}),a&&"function"==typeof a&&a(e?e:null,o.data[0])})},isLocked:function(){return plugHash.modules.booth.isLocked},isCycling:function(){return plugHash.modules.booth.shouldCycle},media:{addYoutubeVideo:function(s,e,t){if(!plugHash.modules.playlists.get(e))return!1;var a=/^.*(youtu.be\/|v\/|u\/\w\/|embed\/|watch\?v=|\&v=)([^#\&\?]*).*/,o=s.match(a);return o&&11==o[2].length?($.getJSON("https://www.googleapis.com/youtube/v3/videos?id="+o[2]+"&part=snippet,contentDetails,statistics,status&key=AIzaSyCXdCG_sDuHISSSFcbUmJatH70nS9NYnTs",function(s){if(!s||!s.items||!s.items.length)return void("function"==typeof t&&t(null));var a=s.items[0],o=a.contentDetails.duration.match(/^P([0-9]+D|)?T?([0-9]+H|)?([0-9]+M|)?([0-9]+S|)?$/).reverse();o.pop();var n={id:0,format:1,cid:a.id,author:"",title:"",image:a.snippet.thumbnails["default"].url,duration:0},i=a.snippet.title,l=i.indexOf("-"),u=[0,60,3600,86400];l>0?(n.author=i.substr(0,l).trim(),n.title=i.substr(l+1).trim()):(n.author=a.snippet.channelTitle,n.title=i),o.forEach(function(s,e){s&&(n.duration+=parseInt(s.match(/\d{1,}/)[0])*u[e])}),plugHash.utils.addToPlaylist(e,n,!1,function(s){"function"==typeof t&&t(s?null:n)})}).fail(function(){"function"==typeof t&&t(null)}),!0):!1},addSoundCloudSong:function(s,e,t){}},votes:{woot:function(s){var e=API.getUser();if(plugHash.modules.media&&e&&1!=e.vote){var t=plugHash.settings.voting.reverseWoot;(!t||s===!0&&t)&&$("#woot").click()}},meh:function(){var s=API.getUser();plugHash.modules.media&&s&&-1!=s.vote&&$("#meh").click()},grab:function(s,e){"boolean"==typeof s&&(e=s,s=null);var t=plugHash.modules.playlists.getActiveID();s=s||plugHash.settings.voting.grabTo||t;var a=plugHash.modules.media,o=API.getUser(),n=API.getDJ();if(s&&a&&o&&!o.grab&&n&&n.id!=o.id)if(e)plugHash.utils.addToPlaylist(s,a,t==s);else{var i=plugHash.modules.playlists.get(s);if(!i)return;i=i.toJSON(),$("#grab").click();var l=$(".pop-menu.grab li");l.filter(function(s){return $(l[s]).find("span").text()==i.name}).trigger("mousedown")}}}},commands:{shrug:function(s,e){API.sendChat(e.join(" ")+" ¯\\_(ツ)_/¯")},lenny:function(s,e){API.sendChat(e.join(" ")+" ( ͡° ͜ʖ ͡°)")},cat:function(s,e){API.sendChat(e.join(" ")+" =^.^=")},crazy:function(s,e){API.sendChat(e.join(" ")+" {{{(>_<)}}}")},coolsong:function(s,e){API.sendChat(e.join(" ")+" d(^_^)b")},cry:function(s,e){API.sendChat(e.join(" ")+" (╥﹏╥)")},yuno:function(s,e){API.sendChat(e.join(" ")+" ლ(ಠ益ಠლ)")},bearface:function(s,e){API.sendChat(e.join(" ")+" ʕ•ᴥ•ʔ")},wtf:function(s,e){API.sendChat(e.join(" ")+" ಠ_ಠ")},iamfine:function(s,e){API.sendChat(e.join(" ")+" ⁀‿⁀")},iamangry:function(s,e){API.sendChat(e.join(" ")+" ╰_╯")},facepalm:function(s,e){API.sendChat(e.join(" ")+" (>ლ)")},shy:function(s,e){API.sendChat(e.join(" ")+" (｡◕‿◕｡)")},dwi:function(s,e){API.sendChat(e.join(" ")+" (⌐■_■)")},x1:function(s,e){API.sendChat(e.join(" ")+" (ง'̀-'́)ง")},machoman:function(s,e){API.sendChat(e.join(" ")+" ᕦ( ͡° ͜ʖ ͡°)ᕤ")},runsong:function(s,e){API.sendChat(e.join(" ")+" ᕕ(⌐■_■)ᕗ ♪♬")},gasp:function(s,e){API.sendChat(e.join(" ")+" (ʘᗩʘ’)")},creepy:function(s,e){API.sendChat(e.join(" ")+" ╭(ʘ̆~◞౪◟~ʘ̆)╮")},pls:function(s,e){API.sendChat(e.join(" ")+" 〳 •́ ﹏ •̀ 〵")},partyover:function(s,e){API.sendChat(e.join(" ")+" ᕕ{  ͒ ʖ̯  ͒  }ᕗ")},aww:function(s,e){API.sendChat(e.join(" ")+" ʕ ಡ ﹏ ಡ ʔ")},wise:function(s,e){API.sendChat(e.join(" ")+" (҂ ˘ _ ˘ )")},"this":function(s,e){API.sendChat(e.join(" ")+" ☜(ﾟヮﾟ☜)")},squad:function(s,e){API.sendChat(e.join(" ")+" ヽ༼ ຈل͜ຈ༼ ▀̿̿Ĺ̯̿̿▀̿ ̿༽Ɵ͆ل͜Ɵ͆ ༽ﾉ")},itsmagic:function(s,e){API.sendChat(e.join(" ")+" (⊃｡•́‿•̀｡)⊃━☆ﾟ.*･｡ﾟ")},wat:function(s,e){API.sendChat(e.join(" ")+" ʕ ͠° ʖ̫ °͠ ʔ")},whatever:function(s,e){API.sendChat(e.join(" ")+" ¯\\_(⊙_ʖ⊙)_/¯")},m8:function(s,e){API.sendChat(e.join(" ")+" ლ ( ◕  ᗜ  ◕ ) ლ")},cool:function(s,e){API.sendChat(e.join(" ")+" s( ^ ‿ ^)-b")},praise:function(s,e){API.sendChat(e.join(" ")+" ༼つ ◕_◕ ༽つ")},gary:function(s,e){API.sendChat(e.join(" ")+" ᕕ( ᐛ )ᕗ")},afk:function(s,e){var t=plugHash.session.lang.loaded;return 0==e.length?plugHash.utils.addChat("success",t.settings.afkMessage+": "+(plugHash.settings.afkMessage||t.settings.afkMessageDefault),"unignore"):(plugHash.settings.afkMessage=e.join(" "),void plugHash.utils.addChat("success",t.settings.afkMessage+": "+plugHash.settings.afkMessage))},autoleave:function(s,e){var t=plugHash.session.lang.loaded;if(0==e.length)return void(plugHash.settings.autoLeave?plugHash.utils.addChat("success",t.settings.autoLeave+": "+plugHash.session.autoLeave.played+"/"+plugHash.settings.autoLeavePos,"leave-waitlist"):plugHash.utils.addChat("success",t.settings.autoLeave+": "+t.misc.disabled,"leave-waitlist"));var a=parseInt(e.shift());isNaN(a)||1>a||(plugHash.settings.autoLeavePos=a,plugHash.session.autoLeave.played=0,plugHash.utils.addChat("success",t.settings.autoLeave+": "+plugHash.session.autoLeave.played+"/"+plugHash.settings.autoLeavePos,"leave-waitlist"))},addvideo:function(s,e){if(e.length<2)return plugHash.utils.addChat("error",plugHash.session.lang.loaded.commands.addvideo.insufficientArgs);var t=e.shift(),a=e.join(" "),o=plugHash.modules.playlists.findWhere({name:a});return o?void(plugHash.utils.media.addYoutubeVideo(t,o.get("id"),function(s){s?plugHash.utils.addChat("success",plugHash.utils.replaceLang(plugHash.session.lang.loaded.commands.addvideo.added,{author:s.author,title:s.title,playlistname:a}),"playlist-small"):plugHash.utils.addChat("error",plugHash.session.lang.loaded.commands.addvideo.failed,"playlist-small")})||plugHash.utils.addChat("error",plugHash.session.lang.loaded.commands.addvideo.failed,"playlist-small")):plugHash.utils.addChat("error",plugHash.session.lang.loaded.commands.addvideo.playlistNotFound,"playlist-small")},addsong:function(s,e){},move:function(s,e){var t=e.splice(e.length-1),a=e.join(" ");a=a.replace("@",""),self=API.getUser(),plugHash.utils.getUser(a,function(s){return null==s?plugHash.utils.addChat("error",plugHash.session.lang.loaded.commands.noperm,"x-gray"):void(self.role>=3||self.gRole>=3?isNaN(parseInt(t))?plugHash.utils.addChat("error",plugHash.session.lang.loaded.commands.error,"chat-system"):API.getDJ().id!=a.id&&(-1!=API.getWaitListPosition(s.id)?API.moderateMoveDJ(s.id,parseInt(t)):(API.moderateAddDJ(s.id),setTimeout(function(){API.moderateMoveDJ(s.id,parseInt(t))},500))):plugHash.utils.addChat("error",plugHash.session.lang.loaded.commands.error,"chat-system"))})},add:function(s,e){var t=e.join(" ").substr(1),a=plugHash.utils.isLocked(),o=API.getUser(),n=API.getDJ();plugHash.utils.getUser(t,function(s){return null==s?plugHash.utils.addChat("error",plugHash.session.lang.loaded.commands.error,"chat-system"):void((o.role>=2||o.gRole>=3)&&n&&n.id!=s.id?a&&o.role>=3?API.moderateAddDJ(s.id):a&&o.role<3?plugHash.utils.addChat("error",plugHash.session.lang.loaded.commands.noperm,"x-gray"):a||API.moderateAddDJ(s.id):plugHash.utils.addChat("error",plugHash.session.lang.loaded.commands.noperm,"x-gray"))})},remove:function(s,e){var t=API.getUser(),a=e.join(" ").substr(1),o=API.getDJ();plugHash.utils.getUser(a,function(s){return null==s?plugHash.utils.addChat("error",plugHash.session.lang.loaded.commands.error,"chat-system"):void(o&&-1!=API.getWaitListPosition(s)&&(t.role>=1||t.gRole>=3)&&plugHash.utils.ajax("BOOTH/REMOVE/"+s.id,"DELETE"))})},skip:function(s,e){var t=API.getUser(),a=API.getDJ();t.role>=2||t.gRole>=3?a&&5!=a.gRole&&API.moderateForceSkip(a.id):plugHash.utils.addChat("error",plugHash.session.lang.loaded.commands.noperm,"x-gray")},ban:function(s,e){var t=API.getUser(),a=e.join(" ").substr(1);plugHash.utils.getUser(a,function(s){return console.log(s),null==s?plugHash.utils.addChat("error",plugHash.session.lang.loaded.commands.error,"chat-system"):void((t.role>=3||t.gRole>=3)&&plugHash.utils.ajax("BANS/ADD","POST",{userID:s.id,reason:1,duration:"f"}))})},kick:function(s,e){
if(!(e.length<2)){1==e.length&&e.push("day");var t=API.getUser(),a="hour"==e.pop().toLowerCase()?"h":"d",o=e.join(" ").replace("@","");plugHash.utils.getUser(o,function(s){return null==s?plugHash.utils.addChat("error",plugHash.session.lang.loaded.commands.error,"chat-system"):void((t.role>=2||t.gRole>=3)&&plugHash.utils.ajax("BANS/ADD","POST",{userID:s.id,reason:1,duration:a}))})}},clearchat:function(s,e){var t=API.getUser(),a=$("#chat-messages > .cm[data-cid]");if(t.role>=2||t.gRole>=3)for(var o=0;o<a.length;o++){var n=a[o].getAttribute("data-cid");n&&-1==n.indexOf("phash")&&plugHash.utils.deleteChat(n),o==a.length-1&&API.sendChat("/em [/clearchat] "+(plugHash.session.lang.loaded.commands.clearchat?plugHash.session.lang.loaded.commands.clearchat:"Chat cleared"))}else plugHash.utils.addChat("error",plugHash.session.lang.loaded.commands.noperm,"x-gray")},"delete":function(s,e){var t=API.getUser(),a=e.join(" ").replace("@",""),o=$(".cm.message").filter(function(s,e){return $(e).find(".un").text()==a});if(t.role>=2||t.gRole>=3)for(var n=0;n<o.length;n++){var i=o[n].getAttribute("data-cid").split("-");plugHash.utils.getUser(a,function(s){i[0]==s.id&&plugHash.utils.deleteChat(i.join("-")),n==o.length-1&&API.sendChat("/em [/delete @"+s.username+"] "+(plugHash.session.lang.loaded.commands["delete"]?plugHash.session.lang.loaded.commands["delete"]:"Deleted ."))})}else plugHash.utils.addChat("error",plugHash.session.lang.loaded.commands.noperm,"x-gray")},whois:function(s,e){if(0!=e.length){var t=e.join(" ");"@"==t.charAt(0)&&(t=t.substr(1)),plugHash.utils.getUser(t,function(s){if(!s)return console.log("Failed to get user");var e=API.getWaitListPosition(s.id),t="ID: "+s.id+"<br>Joined: "+new Date(s.joined).toLocaleString()+" UTC<br>Level: "+s.level+"<br>Language: "+s.language+"<br>WaitList spot: "+(-1==e?"Not in WaitList":e+1)+"<br>"+(s.slug?'Profile: <a href="https://plug.dj/@/'+s.slug+'" target="_blank">Click here</a>':"");plugHash.utils.addChat("success",t,"filter",s)})}},link:function(s,e){var t=API.getDJ(),a=API.getMedia();t&&(2==a.format?SC.get("/tracks/"+a.cid,function(s){plugHash.utils.addChat("log",'<a href="'+s.permalink_url+'" target="_blank">'+a.author+" - "+a.title+"</a>","filter")}):plugHash.utils.addChat("log",'<a href="https://youtu.be/'+a.cid+'" target="_blank">'+a.author+" - "+a.title+"</a>","filter"))},reload:function(s,e){$.getScript(plugHash.consts.links.plugHash),plugHash.kill()},kill:function(s,e){plugHash.kill()}},events:{API:{advance:function(s){if(plugHash.session.dj=s.dj,s.media&&(plugHash.settings.voting.autoWoot&&plugHash.utils.votes.woot(),plugHash.settings.voting.autoMeh&&plugHash.utils.votes.meh(),plugHash.settings.voting.autoGrab&&plugHash.utils.votes.grab(plugHash.settings.voting.silentGrab)),s.lastPlay){var e=API.getUser();e&&s.lastPlay.dj&&s.lastPlay.dj.id==e.id&&plugHash.settings.autoLeave&&(plugHash.session.autoLeave.played++,plugHash.settings.autoLeavePos===plugHash.session.autoLeave.played&&(plugHash.session.autoLeave.played=0,plugHash.settings.autoJoin&&$("#autoJoin").click(),API.djLeave(),$("#autoLeave").click()))}plugHash.ui.voteRollover.updvote()},voteUpdate:function(s){plugHash.ui.voteRollover.vote(s),plugHash.settings.notifications.currentSong.woot&&1==s.vote?plugHash.utils.addChat("woot",plugHash.session.lang.loaded.notifications.user.userWooted,"woot",s.user):plugHash.settings.notifications.currentSong.meh&&-1==s.vote&&plugHash.utils.addChat("meh",plugHash.session.lang.loaded.notifications.user.userMehd,"meh",s.user)},userJoin:function(s){plugHash.settings.notifications.join.user&&plugHash.utils.addChat("userJoined",plugHash.session.lang.loaded.notifications.user.userJoined,"community-users",s)},_userLeave:function(s){if(plugHash.settings.notifications.leave.user){var e=plugHash.session.waitList.filter(function(e){return e.id==s.id})[0],t=plugHash.session.waitList.indexOf(e),a=plugHash.session.dj,o=t>0||a&&a.id==s.id;o&&API.chatLog(s.username+" left, waitlist spot: "+(t>0?t:"DJ"))}},userLeave:function(s){plugHash.settings.notifications.leave.user&&plugHash.utils.addChat("userLeft",plugHash.session.lang.loaded.notifications.user.userLeft,"community-users",s)},guestJoin:function(s){plugHash.settings.notifications.join.user&&plugHash.utils.addChat("userJoined",plugHash.session.lang.loaded.notifications.guestJoin,"users-white")},guestLeave:function(s){plugHash.settings.notifications.leave.user&&plugHash.utils.addChat("userLeft",plugHash.session.lang.loaded.notifications.guestLeave,"users-white")},grabUpdate:function(s){if(plugHash.settings.notifications.currentSong.grab){var e=API.getMedia();2==e.format?SC.get("/tracks/"+e.cid,function(t){plugHash.utils.addChat("userGrabbed",plugHash.session.lang.loaded.notifications.user.userGrabbed+'<br /><a href="'+t.permalink_url+'" target="_blank">'+e.author+" - "+e.title+"</a>","grab",s.user)}):plugHash.utils.addChat("userGrabbed",plugHash.session.lang.loaded.notifications.user.userGrabbed+'<br /><a href="https://youtu.be/'+e.cid+'" target="_blank">'+e.author+" - "+e.title+"</a>","grab",s.user)}},waitListUpdate:function(s){plugHash.session.waitList=s},chatCommand:function(s){var e=s.substr(1).trim().split(" "),t=e.shift().toLowerCase();plugHash.commands.hasOwnProperty(t)&&"function"==typeof plugHash.commands[t]&&plugHash.commands[t](s,e)}},modules:{lockedChange:function(){plugHash.events.modules.waitListChange()},waitListChange:function(){plugHash.settings.autoJoin&&plugHash.events.modules.utils.joinBooth()},changeGuests:function(s){var e=s.previousAttributes().guests,t=s.changedAttributes().guests;t>e&&API.trigger("guestJoin",t),e>t&&API.trigger("guestLeave",t)},firstChat:function(s){plugHash.settings.chatMentions&&plugHash.settings.chatMentionsArray.length>0&&plugHash.utils.customMention(s),plugHash.settings.customEmotes&&plugHash.utils.emotes.replaceEmotes(s)},lastChat:function(s){var e=$('div[data-cid="'+s.cid+'"]');plugHash.ui.addDeleteButton(s);var t=API.getUser(s.uid),a=t&&Math.max(t.role,t.gRole)>2;if(plugHash.settings.afkEnabled&&a&&s.message.match(/^!afkdisable/i)&&($("#afkMessage").click(),API.sendChat("@"+s.un+" AFK Message disabled"),plugHash.utils.addChat("log",s.un+plugHash.session.lang.loaded.commands.afkDisable,"unignore")),plugHash.settings.autoJoin&&a&&s.message.match(/^!joindisable/i)&&($("#autoJoin").click(),API.sendChat("@"+s.un+" Auto Join disabled"),plugHash.utils.addChat("log",s.un+plugHash.session.lang.loaded.commands.joinDisable,"join-waitlist")),plugHash.settings.afkEnabled){var o=(new Date).getTime(),n=API.getUser(),i=o>plugHash.session.afkMessage.chat.lastSent+3e5&&n&&-1!=s.message.indexOf("@"+n.username);i&&API.sendChat("[AFK] @"+s.un+" "+(plugHash.settings.afkMessage||plugHash.session.lang.loaded.settings.afkMessageDefault)),(i||n&&s.uid==n.id)&&(plugHash.session.afkMessage.chat.lastSent=o)}if(e.length){for(var l=plugHash.utils.team.getRole(s.uid).reverse(),u=e.find(".from");l.length>0&&u.length>0;)u.prepend('<i class="icon rank rank-'+l.pop()+'"></i>');e.addClass("communityRole-"+plugHash.consts.plugRoles[t.role])}},roomJoined:function(){var s=API.getUser().vote;plugHash.settings.voting.autoWoot&&0==s&&plugHash.utils.votes.woot(),plugHash.settings.voting.autoMeh&&0==s&&plugHash.utils.votes.meh(),plugHash.settings.voting.autoGrab&&plugHash.utils.votes.grab(plugHash.settings.voting.silentGrab),plugHash.settings.autoJoin&&plugHash.events.modules.utils.joinBooth(),plugHash.session.dj=API.getDJ,plugHash.session.waitList=API.getWaitList(),plugHash.session.autoLeave.played=0,plugHash.ui.voteRollover.updvote()},mediaChange:function(s){plugHash.modules.media&&plugHash.modules.media.get("remaining")<0&&plugHash.modules.media.set("remaining",plugHash.modules.media.get("duration")-plugHash.modules.media.get("elapsed"))},mediaChangeRemaining:function(s){0==API.getUser().vote&&plugHash.settings.voting.reverseWoot&&10==s.changedAttributes().remaining&&plugHash.utils.votes.woot(!0)},userRolloverChange:function(s,e,t){var a=plugHash.modules.rollover,o=a.user;if(a._showSimple(s,e,t),o!==s){var n=API.getUser();n.gRole||a.$meta.hasClass("user-id")||(a.$meta.addClass("has-id"),a.$meta.has(".user-id").length||a.$meta.append('<span class="user-id"></span>'),a.$meta.find(".user-id").text(plugHash.session.lang.loaded.misc.rolloverID+s.get("id"))),a.$meta.find('i[class*="rank rank-"]').remove();for(var i=plugHash.utils.team.getRole(s.get("id"));i.length>0;)a.$meta.find(".status").prepend('<i class="icon rank rank-'+i.pop()+'"></i>')}},utils:{canUserJoin:function(){if(null==plugHash.modules.booth||null==plugHash.modules.waitlist)return!1;var s=plugHash.modules.booth.toJSON(),e=plugHash.modules.waitlist,t=API.getUser();return t&&!e.isTheUserPlaying&&!e.isTheUserWaiting&&e.length<50&&((t.role>0||t.gRole)&&s.isLocked||!s.isLocked)},joinBooth:function(){this.canUserJoin&&API.djJoin()}}},ui:{resize:function(){plugHash.ui.voteRollover.resize()}}},modules:{require:null,media:null,events:null,user:null,users:null,rollover:null,settings:null,compress:null,booth:null,room:null,score:null,urls:null,emojis:null,playlists:null,waitlist:null,lang:null,util:null,utils:{chat:{chat:null,resetType:function(){return this.chat&&this.chat.context&&(this.chat.context.lastType=null)}},playlists:{getActive:function(){return this.get(plugHash.modules.playlists.getActiveID())},get:function(s){var e=plugHash.modules.playlists.get(s);return e?e.toJSON():null},getAll:function(){return plugHash.modules.playlists.toJSON()}}},init:function(){this.require=require.s.contexts._.defined;var s=Object.keys(this.require);for(var e in s)if(!("object"!=typeof this.require[s[e]]&&"function"!=typeof this.require[s[e]]||!Object.keys(this.require[s[e]]).length||Object.keys(this.require[s[e]]).length<1)){var t=this.require[s[e]];this.waitlist=null!=t.isTheUserWaiting?t:this.waitlist,this.events=t._events&&t._events["chat:receive"]?t:this.events,this.media=t.attributes&&t.attributes.media?t:this.media,this.booth=t.attributes&&null!=t.attributes.waitingDJs?t:this.booth,this.user=t.attributes&&null!=t.attributes.username?t:this.user,this.room=t.attributes&&null!=t.attributes.joinTime?t:this.room,this.users=t._events&&null!=t._events["change:avatarID"]?t:this.users,this.score=t._events&&null!=t._events["change:positive"]?t:this.score,this.playlists="undefined"!=typeof t.activeMedia?t:this.playlists,this.urls="undefined"!=typeof t.scThumbnail?t:this.urls,this.emojis="undefined"!=typeof t.replace_colons?t:this.emojis,this.compress=t.decompressFromUTF16&&t.compressToUTF16?t:this.compress,this.rollover=t.el&&"user-rollover"==t.el.id?t:this.rollover,this.settings=t.settings?t:this.settings,this.util=t.isorx?t:this.util}this.lang=this.require["lang/Lang"],this.events&&this.events._events&&this.events._events["chat:receive"]&&(this.utils.chat.chat=this.events._events["chat:receive"].filter(function(s){return"object"==typeof s.context&&s.context.hasOwnProperty("lastType")})[0]||null)}},storage:{save:function(){plugHash.settings.version=plugHash.consts.version,localStorage.phash=JSON.stringify(plugHash.settings)},load:function(){try{var s=JSON.parse(localStorage.phash);plugHash.settings.version=plugHash.consts.version,plugHash.settings=$.extend({},plugHash.settings,s)}catch(e){}}},init:function(){window.pHash=!0,plugHash.storage.load(),plugHash.modules.init(),plugHash.utils.team.loadTeam();var s=plugHash.settings.lang||API.getUser().language||plugHash.settings.defaultLang;plugHash.utils.loadLang(s,function(e){plugHash.session.lang.language=s,plugHash.session.dj=API.getDJ(),plugHash.session.currentUser=API.getUser(),plugHash.loadEvents(),plugHash.ui.loadUI(),plugHash.ui.loadCSS(plugHash.consts.links.css),plugHash.utils.emotes.getEmotes();var t=plugHash.modules.utils.playlists.getActive();plugHash.settings.voting.grabTo=t?t.id:null,plugHash.events.modules.roomJoined();var a=plugHash.session.lang.loaded.running;plugHash.utils.addSpecial("hash",a,"rank rank-hash")}),"undefined"==typeof API._dispatch&&(API._dispatch=API.dispatch,API.dispatch=function(s,e){API.trigger("_"+s,e),API._dispatch(s,e)}),"undefined"==typeof RegExp.escape&&(RegExp.escape=function(s){return s.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&")})},kill:function(){plugHash.modules.events.trigger("tooltip:hide"),plugHash.stopEvents(),plugHash.ui.unloadCSS(),plugHash.ui.unloadUI(),plugHash.utils.addChat("log",plugHash.session.lang.loaded.killmsg,"dialog-close"),window.pHash=!1,plugHash=void 0},loadEvents:function(){API.on(plugHash.events.API);var s=plugHash.modules;null!=s.booth&&(s.booth.on("change:isLocked",plugHash.events.modules.lockedChange),s.booth.on("change:waitingDJs",plugHash.events.modules.waitListChange)),null!=s.room&&s.room.on("change:guests",plugHash.events.modules.changeGuests),null!=s.events&&(s.events.on("chat:receive",plugHash.events.modules.firstChat),s.events._events["chat:receive"].unshift(plugHash.modules.events._events["chat:receive"].pop()),s.events.on("chat:receive",plugHash.events.modules.lastChat),s.events.on("room:joined",plugHash.events.modules.roomJoined)),null!=s.media&&(s.media.on("change:media",plugHash.events.modules.mediaChange),s.media.on("change:remaining",plugHash.events.modules.mediaChangeRemaining)),s.rollover._showSimple=s.rollover.showSimple,s.rollover.showSimple=plugHash.events.modules.userRolloverChange},stopEvents:function(){API.off(plugHash.events.API);var s=plugHash.modules;null!=s.booth&&(s.booth.off("change:isLocked",plugHash.events.modules.lockedChange),s.booth.off("change:waitingDJs",plugHash.events.modules.waitListChange)),null!=s.room&&s.room.off("change:guests",plugHash.events.modules.changeGuests),null!=s.events&&(s.events.off("chat:receive",plugHash.events.modules.firstChat),s.events.off("chat:receive",plugHash.events.modules.lastChat),s.events.off("room:joined",plugHash.events.modules.roomJoined)),null!=s.media&&(s.media.off("change:media",plugHash.events.modules.mediaChange),s.media.off("change:remaining",plugHash.events.modules.mediaChangeRemaining)),s.rollover.showSimple=s.rollover._showSimple,delete s.rollover._showSimple}};plugHash.init()}
